!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("three"),require("d3-array"),require("d3-geo"),require("d3-geo-projection")):"function"==typeof define&&define.amd?define(["exports","three","d3-array","d3-geo","d3-geo-projection"],r):r(e.Planck=e.Planck||{},e.THREE,e.d3,e.d3,e.d3)}(this,function(e,r,t,n,o){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,r=Symbol(e);return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return void 0===e[r]&&(e[r]=t({})),e[r]}}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){return function n(o,i){try{var u=r[o](i),a=u.value}catch(e){return void t(e)}if(!u.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}("next")})}},s=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")},c=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),f=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},l=function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)},h=function(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r},p=function(){return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,r){var t=[],n=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(n=(u=a.next()).done)&&(t.push(u.value),!r||t.length!==r);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(o)throw i}}return t}(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),v=function(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)},d=i("Division"),y=function(){function e(r,t){s(this,e);var n=d(this);n.level=r,n.code=t}return c(e,[{key:"properties",value:function(){var e=a(regeneratorRuntime.mark(function e(r){var t,n,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.level.properties(r);case 2:if(t=e.sent,n=this.code,void 0!==(o=t[n])){e.next=8;break}throw i=this.level.identifier,new Error("Could not find properties for "+i+" "+n);case 8:return e.abrupt("return",o);case 9:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"bounds",value:function(){var e=a(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.properties(r);case 2:return e.abrupt("return",e.sent.bounds);case 3:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"area",value:function(){var e=a(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.properties(r);case 2:return e.abrupt("return",e.sent.area);case 3:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"centroid",value:function(){var e=a(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.properties(r);case 2:return e.abrupt("return",e.sent.centroid);case 3:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"poleOfInaccessibility",value:function(){var e=a(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.properties(r);case 2:return e.abrupt("return",e.sent.poleOfInaccessibility);case 3:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"geometry",value:function(){var e=a(regeneratorRuntime.mark(function e(r,t){var n,o,i,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.level.geometries(r,t);case 2:if(n=e.sent,o=this.code,void 0!==(i=n[o])){e.next=8;break}throw u=this.level.identifier,new Error("Could not find "+r+" geometry for "+u+" "+o);case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}},e,this)}));return function(r,t){return e.apply(this,arguments)}}()},{key:"shapeGeometry",value:function(){var e=a(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.geometry("shapes",r));case 1:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"outlineGeometry",value:function(){var e=a(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.geometry("outlines",r));case 1:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"borderGeometry",value:function(){var e=a(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.geometry("borders",r));case 1:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"subdivisionGeometry",value:function(){var e=a(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.geometry("subdivisions",r));case 1:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"belongsTo",value:function(e){return e.level===this.level.superlevel&&e.code===this.level.coder.super(this.code)}},{key:"code",get:function(){return d(this).code}},{key:"level",get:function(){return d(this).level}},{key:"geography",get:function(){return this.level.geography}},{key:"data",get:function(){var e=this,r=d(this);return void 0===r.data&&(r.data=this.level.data.find(function(r){return r.code===e.code})),r.data}},{key:"name",get:function(){return this.data.name}},{key:"localizedName",get:function(){return this.data.localizedName||this.data.name}},{key:"neighbors",get:function(){var e=this,r=d(this);return void 0===r.neighbors&&(r.neighbors=this.data.neighbors.map(function(r){return e.constructor.for(r)})),[].concat(v(r.neighbors))}},{key:"superdivision",get:function(){var e=this,r=d(this);if(void 0===r.superdivision){var t=this.level.superlevel;r.superdivision=t?t.divisions.find(function(r){return e.belongsTo(r)}):null}return r.superdivision}},{key:"subdivisions",get:function(){var e=this,r=d(this);if(void 0===r.subdivisions){var t=this.level.sublevel;r.subdivisions=t?t.divisions.filter(function(r){return r.belongsTo(e)}):[]}return[].concat(v(r.subdivisions))}}]),e}(),g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function m(e,r){return e(r={exports:{}},r.exports),r.exports}var x=m(function(e,r){function t(e,r){for(var t=0,n=e.length-1;n>=0;n--){var o=e[n];"."===o?e.splice(n,1):".."===o?(e.splice(n,1),t++):t&&(e.splice(n,1),t--)}if(r)for(;t--;t)e.unshift("..");return e}var n=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(e){return n.exec(e).slice(1)};function i(e,r){if(e.filter)return e.filter(r);for(var t=[],n=0;n<e.length;n++)r(e[n],n,e)&&t.push(e[n]);return t}r.resolve=function(){for(var e="",r=!1,n=arguments.length-1;n>=-1&&!r;n--){var o=n>=0?arguments[n]:process.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(e=o+"/"+e,r="/"===o.charAt(0))}return e=t(i(e.split("/"),function(e){return!!e}),!r).join("/"),(r?"/":"")+e||"."},r.normalize=function(e){var n=r.isAbsolute(e),o="/"===u(e,-1);return(e=t(i(e.split("/"),function(e){return!!e}),!n).join("/"))||n||(e="."),e&&o&&(e+="/"),(n?"/":"")+e},r.isAbsolute=function(e){return"/"===e.charAt(0)},r.join=function(){var e=Array.prototype.slice.call(arguments,0);return r.normalize(i(e,function(e,r){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},r.relative=function(e,t){function n(e){for(var r=0;r<e.length&&""===e[r];r++);for(var t=e.length-1;t>=0&&""===e[t];t--);return r>t?[]:e.slice(r,t-r+1)}e=r.resolve(e).substr(1),t=r.resolve(t).substr(1);for(var o=n(e.split("/")),i=n(t.split("/")),u=Math.min(o.length,i.length),a=u,s=0;s<u;s++)if(o[s]!==i[s]){a=s;break}var c=[];for(s=a;s<o.length;s++)c.push("..");return(c=c.concat(i.slice(a))).join("/")},r.sep="/",r.delimiter=":",r.dirname=function(e){var r=o(e),t=r[0],n=r[1];return t||n?(n&&(n=n.substr(0,n.length-1)),t+n):"."},r.basename=function(e,r){var t=o(e)[2];return r&&t.substr(-1*r.length)===r&&(t=t.substr(0,t.length-r.length)),t},r.extname=function(e){return o(e)[3]};var u="b"==="ab".substr(-1)?function(e,r,t){return e.substr(r,t)}:function(e,r,t){return r<0&&(r=e.length+r),e.substr(r,t)}}),b=(x.resolve,x.normalize,x.isAbsolute,x.join,x.relative,x.sep,x.delimiter,x.dirname,x.basename,x.extname,function(){try{if(new Function("return this === window")())return!0}catch(e){}return!1}()),w=!b&&function(){try{if(new Function("return this === self")())return!0}catch(e){}return!1}(),k=!b&&!w&&function(){try{if(new Function("return this === global")())return!0}catch(e){}return!1}(),j=b?window:w?self:k?global:void 0,q={isBrowser:b,isWorker:w,isNode:k,scope:j};function A(e){var r=void 0,t=void 0;if("string"==typeof e)t=e,r=e;else{var n=Object.keys(e);r=e[t=p(n,1)[0]]}if(process.browser)return j[r];if(k)try{return require(t)}catch(e){}}function O(e){try{return A(e)}catch(e){j.process={browser:!k}}return A(e)}function S(e){var r=O(e);if(void 0===r){if(k)throw new Error('Could not resolve module "'+e+'"');return{}}return r}Object.assign(O,{optional:function(e){var r=O(e);return void 0===r?{}:r},required:function(e){var r=O(e);if(void 0===r)throw k?new Error('Could not resolve module "'+e+'"'):new Error('"'+e+'" isn’t defined in the global scope');return r},node:S,browser:function(e){var r=O(e);if(void 0===r){if(!k)throw new Error('"'+e+'" isn’t defined in the global scope');return{}}return r}});var C=S("path"),R={resolve:k?C.resolve:function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return x.resolve.apply(x,["/"].concat(r))},normalize:k?C.normalize:x.normalize,join:k?C.join:x.join,relative:k?C.relative:x.relative,dirname:k?C.dirname:x.dirname,basename:k?C.basename:x.basename,extname:k?C.extname:x.extname,delimiter:k?C.delimiter:x.delimiter,sep:k?C.sep:x.sep},E={},T={},G=34,M=10,P=13;function N(e){return new Function("d","return {"+e.map(function(e,r){return JSON.stringify(e)+": d["+r+"]"}).join(",")+"}")}function B(e){var r=new RegExp('["'+e+"\n\r]"),t=e.charCodeAt(0);function n(e,r){var n,o=[],i=e.length,u=0,a=0,s=i<=0,c=!1;function f(){if(s)return T;if(c)return c=!1,E;var r,n,o=u;if(e.charCodeAt(o)===G){for(;u++<i&&e.charCodeAt(u)!==G||e.charCodeAt(++u)===G;);return(r=u)>=i?s=!0:(n=e.charCodeAt(u++))===M?c=!0:n===P&&(c=!0,e.charCodeAt(u)===M&&++u),e.slice(o+1,r-1).replace(/""/g,'"')}for(;u<i;){if((n=e.charCodeAt(r=u++))===M)c=!0;else if(n===P)c=!0,e.charCodeAt(u)===M&&++u;else if(n!==t)continue;return e.slice(o,r)}return s=!0,e.slice(o,i)}for(e.charCodeAt(i-1)===M&&--i,e.charCodeAt(i-1)===P&&--i;(n=f())!==T;){for(var l=[];n!==E&&n!==T;)l.push(n),n=f();r&&null==(l=r(l,a++))||o.push(l)}return o}function o(r){return r.map(i).join(e)}function i(e){return null==e?"":r.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,r){var t,o,i=n(e,function(e,n){if(t)return t(e,n-1);var i,u,a;o=e,t=r?(u=r,a=N(i=e),function(e,r){return u(a(e),r,i)}):N(e)});return i.columns=o||[],i},parseRows:n,format:function(r,t){var n,o,u;return null==t&&(n=r,o=Object.create(null),u=[],n.forEach(function(e){for(var r in e)r in o||u.push(o[r]=r)}),t=u),[t.map(i).join(e)].concat(r.map(function(r){return t.map(function(e){return i(r[e])}).join(e)})).join("\n")},formatRows:function(e){return e.map(o).join("\n")}}}var _=B(",").parse,z=B("\t").parse,Z=function(e,r){if(r=r.split(":")[0],!(e=+e))return!1;switch(r){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e},I=Object.prototype.hasOwnProperty;function U(e){return decodeURIComponent(e.replace(/\+/g," "))}var F={stringify:function(e,r){r=r||"";var t=[];for(var n in"string"!=typeof r&&(r="?"),e)I.call(e,n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.length?r+t.join("&"):""},parse:function(e){for(var r,t=/([^=?&]+)=?([^&]*)/g,n={};r=t.exec(e);n[U(r[1])]=U(r[2]));return n}},J=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,L=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,D=[["#","hash"],["?","query"],["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],H={hash:1,query:1};function V(e){var r,t={},n=void 0===(e=e||g.location||{})?"undefined":u(e);if("blob:"===e.protocol)t=new W(unescape(e.pathname),{});else if("string"===n)for(r in t=new W(e,{}),H)delete t[r];else if("object"===n){for(r in e)r in H||(t[r]=e[r]);void 0===t.slashes&&(t.slashes=L.test(e.href))}return t}function Q(e){var r=J.exec(e);return{protocol:r[1]?r[1].toLowerCase():"",slashes:!!r[2],rest:r[3]}}function W(e,r,t){if(!(this instanceof W))return new W(e,r,t);var n,o,i,a,s,c,f=D.slice(),l=void 0===r?"undefined":u(r),h=this,p=0;for("object"!==l&&"string"!==l&&(t=r,r=null),t&&"function"!=typeof t&&(t=F.parse),r=V(r),n=!(o=Q(e||"")).protocol&&!o.slashes,h.slashes=o.slashes||n&&r.slashes,h.protocol=o.protocol||r.protocol||"",e=o.rest,o.slashes||(f[2]=[/(.*)/,"pathname"]);p<f.length;p++)i=(a=f[p])[0],c=a[1],i!=i?h[c]=e:"string"==typeof i?~(s=e.indexOf(i))&&("number"==typeof a[2]?(h[c]=e.slice(0,s),e=e.slice(s+a[2])):(h[c]=e.slice(s),e=e.slice(0,s))):(s=i.exec(e))&&(h[c]=s[1],e=e.slice(0,s.index)),h[c]=h[c]||n&&a[3]&&r[c]||"",a[4]&&(h[c]=h[c].toLowerCase());t&&(h.query=t(h.query)),n&&r.slashes&&"/"!==h.pathname.charAt(0)&&(""!==h.pathname||""!==r.pathname)&&(h.pathname=function(e,r){for(var t=(r||"/").split("/").slice(0,-1).concat(e.split("/")),n=t.length,o=t[n-1],i=!1,u=0;n--;)"."===t[n]?t.splice(n,1):".."===t[n]?(t.splice(n,1),u++):u&&(0===n&&(i=!0),t.splice(n,1),u--);return i&&t.unshift(""),"."!==o&&".."!==o||t.push(""),t.join("/")}(h.pathname,r.pathname)),Z(h.port,h.protocol)||(h.host=h.hostname,h.port=""),h.username=h.password="",h.auth&&(a=h.auth.split(":"),h.username=a[0]||"",h.password=a[1]||""),h.origin=h.protocol&&h.host&&"file:"!==h.protocol?h.protocol+"//"+h.host:"null",h.href=h.toString()}W.prototype={set:function(e,r,t){var n=this;switch(e){case"query":"string"==typeof r&&r.length&&(r=(t||F.parse)(r)),n[e]=r;break;case"port":n[e]=r,Z(r,n.protocol)?r&&(n.host=n.hostname+":"+r):(n.host=n.hostname,n[e]="");break;case"hostname":n[e]=r,n.port&&(r+=":"+n.port),n.host=r;break;case"host":n[e]=r,/:\d+$/.test(r)?(r=r.split(":"),n.port=r.pop(),n.hostname=r.join(":")):(n.hostname=r,n.port="");break;case"protocol":n.protocol=r.toLowerCase(),n.slashes=!t;break;case"pathname":case"hash":if(r){var o="pathname"===e?"/":"#";n[e]=r.charAt(0)!==o?o+r:r}else n[e]=r;break;default:n[e]=r}for(var i=0;i<D.length;i++){var u=D[i];u[4]&&(n[u[1]]=n[u[1]].toLowerCase())}return n.origin=n.protocol&&n.host&&"file:"!==n.protocol?n.protocol+"//"+n.host:"null",n.href=n.toString(),n},toString:function(e){e&&"function"==typeof e||(e=F.stringify);var r,t=this,n=t.protocol;n&&":"!==n.charAt(n.length-1)&&(n+=":");var o=n+(t.slashes?"//":"");return t.username&&(o+=t.username,t.password&&(o+=":"+t.password),o+="@"),o+=t.host+t.pathname,(r="object"===u(t.query)?e(t.query):t.query)&&(o+="?"!==r.charAt(0)?"?"+r:r),t.hash&&(o+=t.hash),o}},W.extractProtocol=Q,W.location=V,W.qs=F;var Y=W,$=S("fs").readFile,X=S("request");function K(e,r){if(k){var t=function(e,r){var t=void 0,n=void 0,o=new Promise(function(){for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];t=r[0],n=r[1]});if(r.local)$(e,r.encoding,function(e,r){e?n(e):t(r)}),o.abort=function(){};else{var i=X({url:e,headers:r.headers||{},qs:r.query||{},encoding:r.encoding},function(e,r){e?n(e):((r.statusCode<200||r.statusCode>=300)&&n(r.statusCode),t(r.body))});i.on("abort",function(){n(0)}),o.abort=function(){i.abort()}}return o}(e,r);if("json"===r.type){var n=t.then(function(e){if("string"!=typeof e)throw new Error("Response is unexpectedly not a string");return JSON.parse(e)});return n.abort=function(){t.abort()},n}if("arraybuffer"===r.type){var o=t.then(function(e){if(!(e instanceof Buffer))throw new Error("Response is unexpectedly not a buffer");for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),n=0;n<e.length;++n)t[n]=e[n];return r});return o.abort=function(){t.abort()},o}return t}return function(e,r){var t=void 0,n=void 0,o=new Promise(function(){for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];t=r[0],n=r[1]}),i=new Y(e,!0);r.query&&i.set("query",Object.assign({},i.query,r.query));var u=new XMLHttpRequest;if(u.open("get",i.toString(),!0),r.headers)for(var a=Object.keys(r.headers),s=0;s<a.length;++s)u.setRequestHeader.apply(u,v(r.headers[a[s]]));return u.responseType=r.type,u.addEventListener("loadend",function(e){u.status<200||u.status>=300?n(u.status):null!==u.response||"json"!==r.type?t(u.response):n(new Error("Could not parse JSON"))},!1),u.send(),o.abort=function(){u.abort()},o}(e,r)}function ee(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];var n=r[0],o=r[1];"string"!=typeof n&&(n=(o=n).url);if("string"!=typeof n)throw new Error("The first argument or options.url must be a string");return[n,o=Object.assign({},{type:"text",local:!1,encoding:"utf-8"},o)]}function re(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=e.toJSON(),n=t.data||{},o=[],i=r;if(n.index){var u=e.index.array,a=u.buffer;o.push([a,i]),n.index.array=[i,u.length],i+=a.byteLength}if(n.attributes)for(var s=Object.keys(n.attributes),c=0;c<s.length;++c){var f=s[c],l=e.attributes[f].array,h=l.buffer;o.push([h,i]),n.attributes[f].array=[i,l.length],i+=h.byteLength}return t.data=n,[t,o,i]}function te(e,t){var n=f({},e,{data:f({},e.data)});if(n.data.index){var o=n.data.index.type,i=new(Function.prototype.bind.apply(q.scope[o],[null].concat([t],v(n.data.index.array))));n.data.index=f({},n.data.index,{array:i})}if(n.data.attributes){for(var u={},a=Object.keys(n.data.attributes),s=0;s<a.length;++s){var c=a[s],l=n.data.attributes[c],h=l.type,p=new(Function.prototype.bind.apply(q.scope[h],[null].concat([t],v(l.array))));u[c]=f({},l,{array:p})}n.data.attributes=u}return(new r.BufferGeometryLoader).parse(n)}function ne(e,r){for(var t=new ArrayBuffer(r),n=new Uint8Array(t),o=0;o<e.length;++o){var i=p(e[o],2),u=i[0],a=i[1];n.set(new Uint8Array(u),a)}return t}Object.assign(K,{text:function(){var e=ee.apply(void 0,arguments),r=p(e,2),t=r[0],n=r[1];return n.type="text",K(t,n)},json:function(){var e=ee.apply(void 0,arguments),r=p(e,2),t=r[0],n=r[1];return n.type="json",K(t,n)},buffer:function(){var e=ee.apply(void 0,arguments),r=p(e,2),t=r[0],n=r[1];return n.type="arraybuffer",n.encoding=null,K(t,n)},csv:function(){var e=ee.apply(void 0,arguments),r=p(e,2),t=r[0],n=r[1],o=this.text(t,n),i=o.then(function(e){return _(e,n.row)});return i.abort=function(){o.abort()},i},tsv:function(){var e=ee.apply(void 0,arguments),r=p(e,2),t=r[0],n=r[1],o=this.text(t,n),i=o.then(function(e){return z(e,n.row)});return i.abort=function(){o.abort()},i}});var oe={packBufferGeometry:function(e){var r=re(e),t=p(r,3);return[t[0],ne(t[1],t[2])]},packBufferGeometries:function(e){var r=function(e){if(Array.isArray(e)){for(var r=[],t=[],n=0,o=0;o<e.length;++o){var i=re(e[o],n),u=p(i,3),a=u[0],s=u[1],c=u[2];r.push(a),t.push.apply(t,v(s)),n=c}return[r,t,n]}for(var f={},l=[],h=0,d=Object.keys(e),y=0;y<d.length;++y){var g=d[y],m=re(e[g],h),x=p(m,3);a=x[0],s=x[1],c=x[2],f[g]=a,l.push.apply(l,v(s)),h=c}return[f,l,h]}(e),t=p(r,3);return[t[0],ne(t[1],t[2])]},unpackBufferGeometry:function(e,r){return te(e,r)},unpackBufferGeometries:function(e,r){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;++n)t.push(te(e,r));return t}for(var o={},i=Object.keys(e),u=0;u<i.length;++u){var a=i[u];o[a]=te(e[a],r)}return o}},ie=i("DivisionLevel"),ue=function(){function e(r,t){s(this,e);var n=ie(this);n.identifier=r,n.coder=t,n.divisions={},n.properties={},n.geometries={}}return c(e,[{key:"init",value:function(e){ie(this).geography=e}},{key:"division",value:function(e){var r=ie(this),t=r.divisions[e];return void 0===t&&(t=new y(this,e),r.divisions[e]=t),t}},{key:"properties",value:function(){var e=a(regeneratorRuntime.mark(function e(r){var t,n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=ie(this),n=r?r.hash:null,void 0===t.properties[n]&&(o=R.join(R.dirname(this.geography.path),n||"",this.geography.identifier,this.identifier,"properties.json"),t.properties[n]=K.json(o,{local:!0})),e.abrupt("return",t.properties[n]);case 4:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"geometries",value:function(){var e=a(regeneratorRuntime.mark(function e(r,t){var n,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=ie(this),o=t?t.hash:null,void 0===(i=n.geometries[o])&&(i={},n.geometries[o]=i),void 0===i[r]&&(i[r]=this.requestGeometries(r,t)),e.abrupt("return",i[r]);case 6:case"end":return e.stop()}},e,this)}));return function(r,t){return e.apply(this,arguments)}}()},{key:"requestGeometries",value:function(){var e=a(regeneratorRuntime.mark(function e(r,t){var n,o,i,u,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=R.join(R.dirname(this.geography.path),t.hash,this.geography.identifier,this.identifier,r),o=void 0,i=void 0,e.prev=3,e.next=6,Promise.all([K.json(n+".json"),K.buffer(n+".buffer")]);case 6:u=e.sent,a=p(u,2),o=a[0],i=a[1],e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(3),e.t0;case 15:return e.abrupt("return",oe.unpackBufferGeometries(o,i));case 16:case"end":return e.stop()}},e,this,[[3,12]])}));return function(r,t){return e.apply(this,arguments)}}()},{key:"identifier",get:function(){return ie(this).identifier}},{key:"coder",get:function(){return ie(this).coder}},{key:"geography",get:function(){return ie(this).geography}},{key:"data",get:function(){var e=ie(this);return void 0===e.data&&(e.data=this.geography.data[this.identifier]),e.data}},{key:"divisions",get:function(){var e=this,r=ie(this);return r.divisions=f({},r.divisions,this.data.reduce(function(t,n){var o,i,u,a=n.code;return void 0===r.divisions[a]?f({},t,(o={},i=a,u=new y(e,a),i in o?Object.defineProperty(o,i,{value:u,enumerable:!0,configurable:!0,writable:!0}):o[i]=u,o)):t},{})),Object.values(r.divisions)}},{key:"codes",get:function(){var e=ie(this);return void 0===e.codes&&(e.codes=this.data.map(function(e){return e.code})),[].concat(v(e.codes))}},{key:"superlevel",get:function(){var e=ie(this);if(void 0===e.superlevel){var r=this.geography.levels,t=r.indexOf(this);if(-1===t)throw new Error("Could not find levels for geography");e.superlevel=r[t-1]||null}return e.superlevel}},{key:"sublevel",get:function(){var e=ie(this);if(void 0===e.sublevel){var r=this.geography.levels,t=r.indexOf(this);if(-1===t)throw new Error("Could not find levels for geography");e.sublevel=r[t+1]||null}return e.sublevel}}]),e}(),ae=i("Geography"),se=function(){function e(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];s(this,e);var n=ae(this);n.identifier=r,n.levels=t,n.properties={},n.geometries={}}return c(e,[{key:"init",value:function(){var e=a(regeneratorRuntime.mark(function e(r,t){var n,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((n=ae(this)).path=r,!t){e.next=8;break}return e.next=5,Promise.resolve(t);case 5:n.data=e.sent,e.next=11;break;case 8:return e.next=10,K.json(r,{local:!0});case 10:n.data=e.sent;case 11:return e.next=13,Promise.all(this.levels.map(function(e){return e.init(o)}));case 13:case"end":return e.stop()}},e,this)}));return function(r,t){return e.apply(this,arguments)}}()},{key:"division",value:function(e,r){var t=this.levels.find(function(r){return r.identifier===e});if(void 0===t)throw new Error("Could not find "+e+" level in geography");return t.division(r)}},{key:"divisions",value:function(e){var r=this.levels.find(function(r){return r.identifier===e});if(void 0===r)throw new Error("Could not find "+e+" level in geography");return r.divisions}},{key:"codes",value:function(e){var r=this.levels.find(function(r){return r.identifier===e});if(void 0===r)throw new Error("Could not find "+e+" level in geography");return r.codes}},{key:"properties",value:function(){var e=a(regeneratorRuntime.mark(function e(r){var t,n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=ae(this),n=r?r.hash:null,void 0===t.properties[n]&&(o=R.join(R.dirname(this.path),n||"",this.identifier,"properties.json"),t.properties[n]=K.json(o,{local:!0})),e.abrupt("return",t.properties[n]);case 4:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"bounds",value:function(){var e=a(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.properties(r);case 2:return e.abrupt("return",e.sent.bounds);case 3:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"area",value:function(){var e=a(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.properties(r);case 2:return e.abrupt("return",e.sent.area);case 3:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"centroid",value:function(){var e=a(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.properties(r);case 2:return e.abrupt("return",e.sent.centroid);case 3:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"poleOfInaccessibility",value:function(){var e=a(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.properties(r);case 2:return e.abrupt("return",e.sent.poleOfInaccessibility);case 3:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"geometry",value:function(){var e=a(regeneratorRuntime.mark(function e(r,t){var n,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=ae(this),o=t?t.hash:null,void 0===(i=n.geometries[o])&&(i={},n.geometries[o]=i),void 0===i[r]&&(i[r]=this.requestGeometry(r,t)),e.abrupt("return",i[r]);case 6:case"end":return e.stop()}},e,this)}));return function(r,t){return e.apply(this,arguments)}}()},{key:"requestGeometry",value:function(){var e=a(regeneratorRuntime.mark(function e(r,t){var n,o,i,u,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=R.join(R.dirname(this.path),t.hash,this.identifier,r),o=void 0,i=void 0,e.prev=3,e.next=6,Promise.all([K.json(n+".json"),K.buffer(n+".buffer")]);case 6:u=e.sent,a=p(u,2),o=a[0],i=a[1],e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(3),e.t0;case 15:return e.abrupt("return",oe.unpackBufferGeometry(o,i));case 16:case"end":return e.stop()}},e,this,[[3,12]])}));return function(r,t){return e.apply(this,arguments)}}()},{key:"shapeGeometry",value:function(){var e=a(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.geometry("shape",r));case 1:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"outlineGeometry",value:function(){var e=a(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.geometry("outline",r));case 1:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"subdivisionGeometry",value:function(){var e=a(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.geometry("subdivision",r));case 1:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"identifier",get:function(){return ae(this).identifier}},{key:"levels",get:function(){var e=ae(this);return[].concat(v(e.levels))}},{key:"path",get:function(){return ae(this).path}},{key:"data",get:function(){var e=ae(this);if(!e.data)throw new Error("Data is missing for "+this.identifier);return e.data}}]),e}(),ce=le,fe=le;function le(e,r,t){t=t||2;var n,o,i,u,a,s,c,f=r&&r.length,l=f?r[0]*t:e.length,h=he(e,0,l,t,!0),p=[];if(!h)return p;if(f&&(h=function(e,r,t,n){var o,i,u,a,s,c=[];for(o=0,i=r.length;o<i;o++)u=r[o]*n,a=o<i-1?r[o+1]*n:e.length,(s=he(e,u,a,n,!1))===s.next&&(s.steiner=!0),c.push(ke(s));for(c.sort(xe),o=0;o<c.length;o++)be(c[o],t),t=pe(t,t.next);return t}(e,r,h,t)),e.length>80*t){n=i=e[0],o=u=e[1];for(var v=t;v<l;v+=t)a=e[v],s=e[v+1],a<n&&(n=a),s<o&&(o=s),a>i&&(i=a),s>u&&(u=s);c=0!==(c=Math.max(i-n,u-o))?1/c:0}return ve(h,p,t,n,o,c),p}function he(e,r,t,n,o){var i,u;if(o===Ge(e,r,t,n)>0)for(i=r;i<t;i+=n)u=Re(i,e[i],e[i+1],u);else for(i=t-n;i>=r;i-=n)u=Re(i,e[i],e[i+1],u);return u&&Ae(u,u.next)&&(Ee(u),u=u.next),u}function pe(e,r){if(!e)return e;r||(r=e);var t,n=e;do{if(t=!1,n.steiner||!Ae(n,n.next)&&0!==qe(n.prev,n,n.next))n=n.next;else{if(Ee(n),(n=r=n.prev)===n.next)break;t=!0}}while(t||n!==r);return r}function ve(e,r,t,n,o,i,u){if(e){!u&&i&&function(e,r,t,n){var o=e;do{null===o.z&&(o.z=we(o.x,o.y,r,t,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,function(e){var r,t,n,o,i,u,a,s,c=1;do{for(t=e,e=null,i=null,u=0;t;){for(u++,n=t,a=0,r=0;r<c&&(a++,n=n.nextZ);r++);for(s=c;a>0||s>0&&n;)0!==a&&(0===s||!n||t.z<=n.z)?(o=t,t=t.nextZ,a--):(o=n,n=n.nextZ,s--),i?i.nextZ=o:e=o,o.prevZ=i,i=o;t=n}i.nextZ=null,c*=2}while(u>1)}(o)}(e,n,o,i);for(var a,s,c=e;e.prev!==e.next;)if(a=e.prev,s=e.next,i?ye(e,n,o,i):de(e))r.push(a.i/t),r.push(e.i/t),r.push(s.i/t),Ee(e),e=s.next,c=s.next;else if((e=s)===c){u?1===u?ve(e=ge(e,r,t),r,t,n,o,i,2):2===u&&me(e,r,t,n,o,i):ve(pe(e),r,t,n,o,i,1);break}}}function de(e){var r=e.prev,t=e,n=e.next;if(qe(r,t,n)>=0)return!1;for(var o=e.next.next;o!==e.prev;){if(je(r.x,r.y,t.x,t.y,n.x,n.y,o.x,o.y)&&qe(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function ye(e,r,t,n){var o=e.prev,i=e,u=e.next;if(qe(o,i,u)>=0)return!1;for(var a=o.x<i.x?o.x<u.x?o.x:u.x:i.x<u.x?i.x:u.x,s=o.y<i.y?o.y<u.y?o.y:u.y:i.y<u.y?i.y:u.y,c=o.x>i.x?o.x>u.x?o.x:u.x:i.x>u.x?i.x:u.x,f=o.y>i.y?o.y>u.y?o.y:u.y:i.y>u.y?i.y:u.y,l=we(a,s,r,t,n),h=we(c,f,r,t,n),p=e.prevZ,v=e.nextZ;p&&p.z>=l&&v&&v.z<=h;){if(p!==e.prev&&p!==e.next&&je(o.x,o.y,i.x,i.y,u.x,u.y,p.x,p.y)&&qe(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,v!==e.prev&&v!==e.next&&je(o.x,o.y,i.x,i.y,u.x,u.y,v.x,v.y)&&qe(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;p&&p.z>=l;){if(p!==e.prev&&p!==e.next&&je(o.x,o.y,i.x,i.y,u.x,u.y,p.x,p.y)&&qe(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;v&&v.z<=h;){if(v!==e.prev&&v!==e.next&&je(o.x,o.y,i.x,i.y,u.x,u.y,v.x,v.y)&&qe(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function ge(e,r,t){var n=e;do{var o=n.prev,i=n.next.next;!Ae(o,i)&&Oe(o,n,n.next,i)&&Se(o,i)&&Se(i,o)&&(r.push(o.i/t),r.push(n.i/t),r.push(i.i/t),Ee(n),Ee(n.next),n=e=i),n=n.next}while(n!==e);return n}function me(e,r,t,n,o,i){var u,a,s=e;do{for(var c=s.next.next;c!==s.prev;){if(s.i!==c.i&&(a=c,(u=s).next.i!==a.i&&u.prev.i!==a.i&&!function(e,r){var t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==r.i&&t.next.i!==r.i&&Oe(t,t.next,e,r))return!0;t=t.next}while(t!==e);return!1}(u,a)&&Se(u,a)&&Se(a,u)&&function(e,r){var t=e,n=!1,o=(e.x+r.x)/2,i=(e.y+r.y)/2;do{t.y>i!=t.next.y>i&&t.next.y!==t.y&&o<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next}while(t!==e);return n}(u,a))){var f=Ce(s,c);return s=pe(s,s.next),f=pe(f,f.next),ve(s,r,t,n,o,i),void ve(f,r,t,n,o,i)}c=c.next}s=s.next}while(s!==e)}function xe(e,r){return e.x-r.x}function be(e,r){if(r=function(e,r){var t,n=r,o=e.x,i=e.y,u=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var a=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=o&&a>u){if(u=a,a===o){if(i===n.y)return n;if(i===n.next.y)return n.next}t=n.x<n.next.x?n:n.next}}n=n.next}while(n!==r);if(!t)return null;if(o===u)return t.prev;var s,c=t,f=t.x,l=t.y,h=1/0;n=t.next;for(;n!==c;)o>=n.x&&n.x>=f&&o!==n.x&&je(i<l?o:u,i,f,l,i<l?u:o,i,n.x,n.y)&&((s=Math.abs(i-n.y)/(o-n.x))<h||s===h&&n.x>t.x)&&Se(n,e)&&(t=n,h=s),n=n.next;return t}(e,r)){var t=Ce(r,e);pe(t,t.next)}}function we(e,r,t,n,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-t)*o)|e<<8))|e<<4))|e<<2))|e<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(r-n)*o)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function ke(e){var r=e,t=e;do{r.x<t.x&&(t=r),r=r.next}while(r!==e);return t}function je(e,r,t,n,o,i,u,a){return(o-u)*(r-a)-(e-u)*(i-a)>=0&&(e-u)*(n-a)-(t-u)*(r-a)>=0&&(t-u)*(i-a)-(o-u)*(n-a)>=0}function qe(e,r,t){return(r.y-e.y)*(t.x-r.x)-(r.x-e.x)*(t.y-r.y)}function Ae(e,r){return e.x===r.x&&e.y===r.y}function Oe(e,r,t,n){return!!(Ae(e,r)&&Ae(t,n)||Ae(e,n)&&Ae(t,r))||qe(e,r,t)>0!=qe(e,r,n)>0&&qe(t,n,e)>0!=qe(t,n,r)>0}function Se(e,r){return qe(e.prev,e,e.next)<0?qe(e,r,e.next)>=0&&qe(e,e.prev,r)>=0:qe(e,r,e.prev)<0||qe(e,e.next,r)<0}function Ce(e,r){var t=new Te(e.i,e.x,e.y),n=new Te(r.i,r.x,r.y),o=e.next,i=r.prev;return e.next=r,r.prev=e,t.next=o,o.prev=t,n.next=t,t.prev=n,i.next=n,n.prev=i,n}function Re(e,r,t,n){var o=new Te(e,r,t);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function Ee(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Te(e,r,t){this.i=e,this.x=r,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ge(e,r,t,n){for(var o=0,i=r,u=t-n;i<t;i+=n)o+=(e[u]-e[i])*(e[i+1]+e[u+1]),u=i;return o}le.deviation=function(e,r,t,n){var o=r&&r.length,i=o?r[0]*t:e.length,u=Math.abs(Ge(e,0,i,t));if(o)for(var a=0,s=r.length;a<s;a++){var c=r[a]*t,f=a<s-1?r[a+1]*t:e.length;u-=Math.abs(Ge(e,c,f,t))}var l=0;for(a=0;a<n.length;a+=3){var h=n[a]*t,p=n[a+1]*t,v=n[a+2]*t;l+=Math.abs((e[h]-e[v])*(e[p+1]-e[h+1])-(e[h]-e[p])*(e[v+1]-e[h+1]))}return 0===u&&0===l?0:Math.abs((l-u)/u)},le.flatten=function(e){for(var r=e[0][0].length,t={vertices:[],holes:[],dimensions:r},n=0,o=0;o<e.length;o++){for(var i=0;i<e[o].length;i++)for(var u=0;u<r;u++)t.vertices.push(e[o][i][u]);o>0&&(n+=e[o-1].length,t.holes.push(n))}return t},ce.default=fe;var Me=Pe;function Pe(e,r){if(!(this instanceof Pe))return new Pe(e,r);if(this.data=e||[],this.length=this.data.length,this.compare=r||Ne,this.length>0)for(var t=this.length>>1;t>=0;t--)this._down(t)}function Ne(e,r){return e<r?-1:e>r?1:0}Pe.prototype={push:function(e){this.data.push(e),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var e=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),e}},peek:function(){return this.data[0]},_up:function(e){for(var r=this.data,t=this.compare,n=r[e];e>0;){var o=e-1>>1,i=r[o];if(t(n,i)>=0)break;r[e]=i,e=o}r[e]=n},_down:function(e){for(var r=this.data,t=this.compare,n=this.length,o=n>>1,i=r[e];e<o;){var u=1+(e<<1),a=u+1,s=r[u];if(a<n&&t(r[a],s)<0&&(u=a,s=r[a]),t(s,i)>=0)break;r[e]=s,e=u}r[e]=i}};var Be=ze,_e=ze;function ze(e,r,t){var n,o,i,u;r=r||1;for(var a=0;a<e[0].length;a++){var s=e[0][a];(!a||s[0]<n)&&(n=s[0]),(!a||s[1]<o)&&(o=s[1]),(!a||s[0]>i)&&(i=s[0]),(!a||s[1]>u)&&(u=s[1])}var c=i-n,f=u-o,l=Math.min(c,f),h=l/2,p=new Me(null,Ze);if(0===l)return[n,o];for(var v=n;v<i;v+=l)for(var d=o;d<u;d+=l)p.push(new Ie(v+h,d+h,h,e));var y=function(e){for(var r=0,t=0,n=0,o=e[0],i=0,u=o.length,a=u-1;i<u;a=i++){var s=o[i],c=o[a],f=s[0]*c[1]-c[0]*s[1];t+=(s[0]+c[0])*f,n+=(s[1]+c[1])*f,r+=3*f}return 0===r?new Ie(o[0][0],o[0][1],0,e):new Ie(t/r,n/r,0,e)}(e),g=new Ie(n+c/2,o+f/2,0,e);g.d>y.d&&(y=g);for(var m=p.length;p.length;){var x=p.pop();x.d>y.d&&(y=x,t&&console.log("found best %d after %d probes",Math.round(1e4*x.d)/1e4,m)),x.max-y.d<=r||(h=x.h/2,p.push(new Ie(x.x-h,x.y-h,h,e)),p.push(new Ie(x.x+h,x.y-h,h,e)),p.push(new Ie(x.x-h,x.y+h,h,e)),p.push(new Ie(x.x+h,x.y+h,h,e)),m+=4)}return t&&(console.log("num probes: "+m),console.log("best distance: "+y.d)),[y.x,y.y]}function Ze(e,r){return r.max-e.max}function Ie(e,r,t,n){this.x=e,this.y=r,this.h=t,this.d=function(e,r,t){for(var n=!1,o=1/0,i=0;i<t.length;i++)for(var u=t[i],a=0,s=u.length,c=s-1;a<s;c=a++){var f=u[a],l=u[c];f[1]>r!=l[1]>r&&e<(l[0]-f[0])*(r-f[1])/(l[1]-f[1])+f[0]&&(n=!n),o=Math.min(o,Ue(e,r,f,l))}return(n?1:-1)*Math.sqrt(o)}(e,r,n),this.max=this.d+this.h*Math.SQRT2}function Ue(e,r,t,n){var o=t[0],i=t[1],u=n[0]-o,a=n[1]-i;if(0!==u||0!==a){var s=((e-o)*u+(r-i)*a)/(u*u+a*a);s>1?(o=n[0],i=n[1]):s>0&&(o+=u*s,i+=a*s)}return(u=e-o)*u+(a=r-i)*a}Be.default=_e;var Fe={min:function(e,r){var t=void 0,n=Number.POSITIVE_INFINITY;if("function"!=typeof r){for(var o=0;o<e.length;++o){var i=e[o];i<n&&(t=i,n=i)}return t}for(var u=0;u<e.length;++u){var a=e[u],s=r(a,u);s<n&&(t=a,n=s)}return t},max:function(e,r){var t=void 0,n=Number.NEGATIVE_INFINITY;if("function"!=typeof r){for(var o=0;o<e.length;++o){var i=e[o];i>n&&(t=i,n=i)}return t}for(var u=0;u<e.length;++u){var a=e[u],s=r(a,u);s>n&&(t=a,n=s)}return t}};function Je(e,r,t,n){this.message=e,this.expected=r,this.found=t,this.location=n,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,Je)}!function(e,r){function t(){this.constructor=e}t.prototype=r.prototype,e.prototype=new t}(Je,Error),Je.buildMessage=function(e,r){var t,n={literal:function(e){return'"'+i(e.text)+'"'},class:function(e){var r,t="";for(r=0;r<e.parts.length;r++)t+=e.parts[r]instanceof Array?u(e.parts[r][0])+"-"+u(e.parts[r][1]):u(e.parts[r]);return"["+(e.inverted?"^":"")+t+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function o(e){return e.charCodeAt(0).toString(16).toUpperCase()}function i(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+o(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+o(e)})}function u(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+o(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+o(e)})}return"Expected "+function(e){var r,t,o,i=new Array(e.length);for(r=0;r<e.length;r++)i[r]=(o=e[r],n[o.type](o));if(i.sort(),i.length>0){for(r=1,t=1;r<i.length;r++)i[r-1]!==i[r]&&(i[t]=i[r],t++);i.length=t}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(e)+" but "+((t=r)?'"'+i(t)+'"':"end of input")+" found."};var Le=function(e,r){r=void 0!==r?r:{};var t,n={},o={svg_path:ve},i=ve,u=function(e){if(!e)return[];for(var r=[],t=0;t<e.length;t++)r=r.concat.apply(r,e[t]);var n=r[0];return n&&"m"==n.code&&(delete n.relative,n.code="M"),r},a=function(e,r){return function(e,r){if(!r)return[e];for(var t=[e],n=0,o=r.length;n<o;n++)t[n+1]=r[n][1];return t}(e,r)},s=/^[Mm]/,c=fe(["M","m"],!1,!1),f=function(e,r,t){var n=Ze(e,[r]);return t&&(n=n.concat(Ze("M"==e?"L":"l",t[1]))),n},l=/^[Zz]/,h=fe(["Z","z"],!1,!1),p=function(){return Ze("Z")},v=/^[Ll]/,d=fe(["L","l"],!1,!1),y=function(e,r){return Ze(e,r)},g=/^[Hh]/,m=fe(["H","h"],!1,!1),x=function(e,r){return Ze(e,r.map(function(e){return{x:e}}))},b=/^[Vv]/,w=fe(["V","v"],!1,!1),k=function(e,r){return Ze(e,r.map(function(e){return{y:e}}))},j=/^[Cc]/,q=fe(["C","c"],!1,!1),A=function(e,r,t){return{x1:e.x,y1:e.y,x2:r.x,y2:r.y,x:t.x,y:t.y}},O=/^[Ss]/,S=fe(["S","s"],!1,!1),C=function(e,r){return{x2:e.x,y2:e.y,x:r.x,y:r.y}},R=/^[Qq]/,E=fe(["Q","q"],!1,!1),T=function(e,r){return{x1:e.x,y1:e.y,x:r.x,y:r.y}},G=/^[Tt]/,M=fe(["T","t"],!1,!1),P=/^[Aa]/,N=fe(["A","a"],!1,!1),B=function(e,r,t,n,o,i){return{rx:e,ry:r,xAxisRotation:t,largeArc:n,sweep:o,x:i.x,y:i.y}},_=function(e,r){return{x:e,y:r}},z=function(e){return 1*e},Z=function(e){return 1*e.join("")},I=/^[01]/,U=fe(["0","1"],!1,!1),F=function(e){return"1"==e},J=function(){return""},L=",",D=ce(",",!1),H=function(e){return e.join("")},V=".",Q=ce(".",!1),W=/^[eE]/,Y=fe(["e","E"],!1,!1),$=/^[+\-]/,X=fe(["+","-"],!1,!1),K=/^[0-9]/,ee=fe([["0","9"]],!1,!1),re=function(e){return e.join("")},te=/^[ \t\n\r]/,ne=fe([" ","\t","\n","\r"],!1,!1),oe=0,ie=[{line:1,column:1}],ue=0,ae=[],se=0;if("startRule"in r){if(!(r.startRule in o))throw new Error("Can't start parsing from rule \""+r.startRule+'".');i=o[r.startRule]}function ce(e,r){return{type:"literal",text:e,ignoreCase:r}}function fe(e,r,t){return{type:"class",parts:e,inverted:r,ignoreCase:t}}function le(r){var t,n=ie[r];if(n)return n;for(t=r-1;!ie[t];)t--;for(n={line:(n=ie[t]).line,column:n.column};t<r;)10===e.charCodeAt(t)?(n.line++,n.column=1):n.column++,t++;return ie[r]=n,n}function he(e,r){var t=le(e),n=le(r);return{start:{offset:e,line:t.line,column:t.column},end:{offset:r,line:n.line,column:n.column}}}function pe(e){oe<ue||(oe>ue&&(ue=oe,ae=[]),ae.push(e))}function ve(){var e,r,t,o,i;for(e=oe,r=[],t=Me();t!==n;)r.push(t),t=Me();if(r!==n)if((t=function(){var e,r,t,o,i,u;if(e=oe,(r=de())!==n){for(t=[],o=oe,i=[],u=Me();u!==n;)i.push(u),u=Me();for(i!==n&&(u=de())!==n?o=i=[i,u]:(oe=o,o=n);o!==n;){for(t.push(o),o=oe,i=[],u=Me();u!==n;)i.push(u),u=Me();i!==n&&(u=de())!==n?o=i=[i,u]:(oe=o,o=n)}t!==n?(r=a(r,t),e=r):(oe=e,e=n)}else oe=e,e=n;return e}())===n&&(t=null),t!==n){for(o=[],i=Me();i!==n;)o.push(i),i=Me();o!==n?e=r=u(t):(oe=e,e=n)}else oe=e,e=n;else oe=e,e=n;return e}function de(){var r,t,o,i,u,l;if(r=oe,(t=function(){var r,t,o,i,u,a,l;if(r=oe,s.test(e.charAt(oe))?(t=e.charAt(oe),oe++):(t=n,0===se&&pe(c)),t!==n){for(o=[],i=Me();i!==n;)o.push(i),i=Me();o!==n&&(i=je())!==n?(u=oe,(a=Se())===n&&(a=null),a!==n&&(l=ge())!==n?u=a=[a,l]:(oe=u,u=n),u===n&&(u=null),u!==n?(t=f(t,i,u),r=t):(oe=r,r=n)):(oe=r,r=n)}else oe=r,r=n;return r}())!==n){for(o=[],i=oe,u=[],l=Me();l!==n;)u.push(l),l=Me();for(u!==n&&(l=ye())!==n?i=u=[u,l]:(oe=i,i=n);i!==n;){for(o.push(i),i=oe,u=[],l=Me();l!==n;)u.push(l),l=Me();u!==n&&(l=ye())!==n?i=u=[u,l]:(oe=i,i=n)}o!==n?r=t=a(t,o):(oe=r,r=n)}else oe=r,r=n;return r}function ye(){var r,t;return l.test(e.charAt(oe))?(t=e.charAt(oe),oe++):(t=n,0===se&&pe(h)),t!==n&&(t=p()),(r=t)===n&&(r=function(){var r,t,o,i;if(r=oe,v.test(e.charAt(oe))?(t=e.charAt(oe),oe++):(t=n,0===se&&pe(d)),t!==n){for(o=[],i=Me();i!==n;)o.push(i),i=Me();o!==n&&(i=ge())!==n?(t=y(t,i),r=t):(oe=r,r=n)}else oe=r,r=n;return r}())===n&&(r=function(){var r,t,o,i;if(r=oe,g.test(e.charAt(oe))?(t=e.charAt(oe),oe++):(t=n,0===se&&pe(m)),t!==n){for(o=[],i=Me();i!==n;)o.push(i),i=Me();o!==n&&(i=me())!==n?(t=x(t,i),r=t):(oe=r,r=n)}else oe=r,r=n;return r}())===n&&(r=function(){var r,t,o,i;if(r=oe,b.test(e.charAt(oe))?(t=e.charAt(oe),oe++):(t=n,0===se&&pe(w)),t!==n){for(o=[],i=Me();i!==n;)o.push(i),i=Me();o!==n&&(i=me())!==n?(t=k(t,i),r=t):(oe=r,r=n)}else oe=r,r=n;return r}())===n&&(r=function(){var r,t,o,i;if(r=oe,j.test(e.charAt(oe))?(t=e.charAt(oe),oe++):(t=n,0===se&&pe(q)),t!==n){for(o=[],i=Me();i!==n;)o.push(i),i=Me();o!==n&&(i=function(){var e,r,t,o,i,u;if(e=oe,(r=xe())!==n){for(t=[],o=oe,(i=Se())===n&&(i=null),i!==n&&(u=xe())!==n?o=i=[i,u]:(oe=o,o=n);o!==n;)t.push(o),o=oe,(i=Se())===n&&(i=null),i!==n&&(u=xe())!==n?o=i=[i,u]:(oe=o,o=n);t!==n?(r=a(r,t),e=r):(oe=e,e=n)}else oe=e,e=n;return e}())!==n?(t=y(t,i),r=t):(oe=r,r=n)}else oe=r,r=n;return r}())===n&&(r=function(){var r,t,o,i;if(r=oe,O.test(e.charAt(oe))?(t=e.charAt(oe),oe++):(t=n,0===se&&pe(S)),t!==n){for(o=[],i=Me();i!==n;)o.push(i),i=Me();o!==n&&(i=function(){var e,r,t,o,i,u;if(e=oe,(r=be())!==n){for(t=[],o=oe,(i=Se())===n&&(i=null),i!==n&&(u=be())!==n?o=i=[i,u]:(oe=o,o=n);o!==n;)t.push(o),o=oe,(i=Se())===n&&(i=null),i!==n&&(u=be())!==n?o=i=[i,u]:(oe=o,o=n);t!==n?(r=a(r,t),e=r):(oe=e,e=n)}else oe=e,e=n;return e}())!==n?(t=y(t,i),r=t):(oe=r,r=n)}else oe=r,r=n;return r}())===n&&(r=function(){var r,t,o,i;if(r=oe,R.test(e.charAt(oe))?(t=e.charAt(oe),oe++):(t=n,0===se&&pe(E)),t!==n){for(o=[],i=Me();i!==n;)o.push(i),i=Me();o!==n&&(i=function(){var e,r,t,o,i,u;if(e=oe,(r=we())!==n){for(t=[],o=oe,(i=Se())===n&&(i=null),i!==n&&(u=we())!==n?o=i=[i,u]:(oe=o,o=n);o!==n;)t.push(o),o=oe,(i=Se())===n&&(i=null),i!==n&&(u=we())!==n?o=i=[i,u]:(oe=o,o=n);t!==n?(r=a(r,t),e=r):(oe=e,e=n)}else oe=e,e=n;return e}())!==n?(t=y(t,i),r=t):(oe=r,r=n)}else oe=r,r=n;return r}())===n&&(r=function(){var r,t,o,i;if(r=oe,G.test(e.charAt(oe))?(t=e.charAt(oe),oe++):(t=n,0===se&&pe(M)),t!==n){for(o=[],i=Me();i!==n;)o.push(i),i=Me();o!==n&&(i=function(){var e,r,t,o,i,u;if(e=oe,(r=je())!==n){for(t=[],o=oe,(i=Se())===n&&(i=null),i!==n&&(u=je())!==n?o=i=[i,u]:(oe=o,o=n);o!==n;)t.push(o),o=oe,(i=Se())===n&&(i=null),i!==n&&(u=je())!==n?o=i=[i,u]:(oe=o,o=n);t!==n?(r=a(r,t),e=r):(oe=e,e=n)}else oe=e,e=n;return e}())!==n?(t=y(t,i),r=t):(oe=r,r=n)}else oe=r,r=n;return r}())===n&&(r=function(){var r,t,o,i;if(r=oe,P.test(e.charAt(oe))?(t=e.charAt(oe),oe++):(t=n,0===se&&pe(N)),t!==n){for(o=[],i=Me();i!==n;)o.push(i),i=Me();o!==n&&(i=function(){var e,r,t,o,i,u;if(e=oe,(r=ke())!==n){for(t=[],o=oe,(i=Se())===n&&(i=null),i!==n&&(u=ke())!==n?o=i=[i,u]:(oe=o,o=n);o!==n;)t.push(o),o=oe,(i=Se())===n&&(i=null),i!==n&&(u=ke())!==n?o=i=[i,u]:(oe=o,o=n);t!==n?(r=a(r,t),e=r):(oe=e,e=n)}else oe=e,e=n;return e}())!==n?(t=y(t,i),r=t):(oe=r,r=n)}else oe=r,r=n;return r}()),r}function ge(){var e,r,t,o,i,u;if(e=oe,(r=je())!==n){for(t=[],o=oe,(i=Se())===n&&(i=null),i!==n&&(u=je())!==n?o=i=[i,u]:(oe=o,o=n);o!==n;)t.push(o),o=oe,(i=Se())===n&&(i=null),i!==n&&(u=je())!==n?o=i=[i,u]:(oe=o,o=n);t!==n?e=r=a(r,t):(oe=e,e=n)}else oe=e,e=n;return e}function me(){var e,r,t,o,i,u;if(e=oe,(r=Ae())!==n){for(t=[],o=oe,(i=Se())===n&&(i=null),i!==n&&(u=Ae())!==n?o=i=[i,u]:(oe=o,o=n);o!==n;)t.push(o),o=oe,(i=Se())===n&&(i=null),i!==n&&(u=Ae())!==n?o=i=[i,u]:(oe=o,o=n);t!==n?e=r=a(r,t):(oe=e,e=n)}else oe=e,e=n;return e}function xe(){var e,r,t,o,i,u;return e=oe,(r=je())!==n?((t=Se())===n&&(t=null),t!==n&&(o=je())!==n?((i=Se())===n&&(i=null),i!==n&&(u=je())!==n?e=r=A(r,o,u):(oe=e,e=n)):(oe=e,e=n)):(oe=e,e=n),e}function be(){var e,r,t,o;return e=oe,(r=je())!==n?((t=Se())===n&&(t=null),t!==n&&(o=je())!==n?e=r=C(r,o):(oe=e,e=n)):(oe=e,e=n),e}function we(){var e,r,t,o;return e=oe,(r=je())!==n?((t=Se())===n&&(t=null),t!==n&&(o=je())!==n?e=r=T(r,o):(oe=e,e=n)):(oe=e,e=n),e}function ke(){var e,r,t,o,i,u,a,s,c,f,l;return e=oe,(r=qe())!==n?((t=Se())===n&&(t=null),t!==n&&(o=qe())!==n?((i=Se())===n&&(i=null),i!==n&&(u=Ae())!==n&&Se()!==n&&(a=Oe())!==n?((s=Se())===n&&(s=null),s!==n&&(c=Oe())!==n?((f=Se())===n&&(f=null),f!==n&&(l=je())!==n?e=r=B(r,o,u,a,c,l):(oe=e,e=n)):(oe=e,e=n)):(oe=e,e=n)):(oe=e,e=n)):(oe=e,e=n),e}function je(){var e,r,t,o;return e=oe,(r=Ae())!==n?((t=Se())===n&&(t=null),t!==n&&(o=Ae())!==n?e=r=_(r,o):(oe=e,e=n)):(oe=e,e=n),e}function qe(){var e;return(e=Re())===n&&(e=Ge()),e!==n&&(e=z(e)),e}function Ae(){var e,r,t;return e=oe,(r=Te())===n&&(r=null),r!==n&&(t=Re())!==n?e=r=[r,t]:(oe=e,e=n),e===n&&(e=oe,(r=Te())===n&&(r=null),r!==n&&(t=Ge())!==n?e=r=[r,t]:(oe=e,e=n)),e!==n&&(e=Z(e)),e}function Oe(){var r;return I.test(e.charAt(oe))?(r=e.charAt(oe),oe++):(r=n,0===se&&pe(U)),r!==n&&(r=F(r)),r}function Se(){var e,r,t,o,i;if(e=oe,r=[],(t=Me())!==n)for(;t!==n;)r.push(t),t=Me();else r=n;if(r!==n)if((t=Ce())===n&&(t=null),t!==n){for(o=[],i=Me();i!==n;)o.push(i),i=Me();o!==n?e=r=[r,t,o]:(oe=e,e=n)}else oe=e,e=n;else oe=e,e=n;if(e===n){if(e=oe,r=oe,(t=Ce())!==n){for(o=[],i=Me();i!==n;)o.push(i),i=Me();o!==n?r=t=[t,o]:(oe=r,r=n)}else oe=r,r=n;r!==n&&(r=J()),e=r}return e}function Ce(){var r;return 44===e.charCodeAt(oe)?(r=L,oe++):(r=n,0===se&&pe(D)),r}function Re(){var r,t,o,i,u,a,s;return r=oe,i=oe,(u=Ge())===n&&(u=null),u!==n?(46===e.charCodeAt(oe)?(a=V,oe++):(a=n,0===se&&pe(Q)),a!==n&&(s=Ge())!==n?i=u=[u,a,s]:(oe=i,i=n)):(oe=i,i=n),i===n&&(i=oe,(u=Ge())!==n?(46===e.charCodeAt(oe)?(a=V,oe++):(a=n,0===se&&pe(Q)),a!==n?i=u=[u,a]:(oe=i,i=n)):(oe=i,i=n)),i!==n&&(i=H(i)),(t=i)!==n?((o=Ee())===n&&(o=null),o!==n?r=t=[t,o]:(oe=r,r=n)):(oe=r,r=n),r===n&&(r=oe,(t=Ge())!==n&&(o=Ee())!==n?r=t=[t,o]:(oe=r,r=n)),r!==n&&(r=H(r)),r}function Ee(){var r,t,o,i;return r=oe,W.test(e.charAt(oe))?(t=e.charAt(oe),oe++):(t=n,0===se&&pe(Y)),t!==n?((o=Te())===n&&(o=null),o!==n&&(i=Ge())!==n?r=t=[t,o,i]:(oe=r,r=n)):(oe=r,r=n),r!==n&&(r=H(r)),r}function Te(){var r;return $.test(e.charAt(oe))?(r=e.charAt(oe),oe++):(r=n,0===se&&pe(X)),r}function Ge(){var r,t;if(r=[],K.test(e.charAt(oe))?(t=e.charAt(oe),oe++):(t=n,0===se&&pe(ee)),t!==n)for(;t!==n;)r.push(t),K.test(e.charAt(oe))?(t=e.charAt(oe),oe++):(t=n,0===se&&pe(ee));else r=n;return r!==n&&(r=re(r)),r}function Me(){var r;return te.test(e.charAt(oe))?(r=e.charAt(oe),oe++):(r=n,0===se&&pe(ne)),r!==n&&(r=J()),r}var Pe,Ne,Be,_e={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var ze in _e)_e[ze.toUpperCase()]=_e[ze];function Ze(e,r){r||(r=[{}]);for(var t=r.length;t--;){var n={code:e,command:_e[e]};for(var o in e==e.toLowerCase()&&(n.relative=!0),r[t])n[o]=r[t][o];r[t]=n}return r}if((t=i())!==n&&oe===e.length)return t;throw t!==n&&oe<e.length&&pe({type:"end"}),Pe=ae,Ne=ue<e.length?e.charAt(ue):null,Be=ue<e.length?he(ue,ue+1):he(ue,ue),new Je(Je.buildMessage(Pe,Ne),Pe,Ne,Be)};Le.parseSVG=Le,Le.makeAbsolute=function(e){var r,t={x:0,y:0},n={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return e.forEach(function(e){for(var o in"moveto"===e.command&&(r=e),e.x0=t.x,e.y0=t.y,n)o in e&&(e[o]+=e.relative?e[n[o]]:0);"x"in e||(e.x=t.x),"y"in e||(e.y=t.y),e.relative=!1,e.code=e.code.toUpperCase(),"closepath"==e.command&&(e.x=r.x,e.y=r.y),t=e}),e};var De=Le;function He(e){this.message=e}function Ve(e,r){return e.x*r.y-e.y*r.x}function Qe(e,r,t){if(e.x<t.x&&t.x<=r.x||r.x<t.x&&t.x<=e.x){var n=e.y;if(e.x!==r.x&&(n=e.y+(r.y-e.y)*(t.x-e.x)/(r.x-e.x)),t.y>n)return 1}return 0}Object.setPrototypeOf(He,Error),He.prototype=Object.create(Error.prototype),He.prototype.name="ImplementationError",He.prototype.message="",He.prototype.constructor=He;var We={winding:function(e){if(!(e.length<3)){var r=e[0],t=Ve(e[e.length-1].v2,r.v1);return(t=e.reduce(function(e,r){return e+Ve(r.v1,r.v2)},t))<0?"ccw":t>0?"cw":void 0}},contains:function(e,r){if(e.length<3)return!1;var t=e[0],n=Qe(e[e.length-1].v2,t.v1,r);return(n=e.reduce(function(e,t){return e+Qe(t.v1,t.v2,r)},n))%2==1},parse:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0,o=0,i=0,u=0,a=0,s=0,c=void 0,f=De(e).reduce(function(e,f){switch(f.code){case"M":case"m":!0===f.relative?(a+=f.x,s+=f.y):(a=f.x,s=f.y),c&&0===c.curves.length&&e.pop(),c=new r.Path,e.push(c),t?c.moveTo(a,-s):c.moveTo(a,s);break;case"L":case"l":!0===f.relative?(a+=f.x,s+=f.y):(a=f.x,s=f.y),t?c.lineTo(a,-s):c.lineTo(a,s);break;case"V":case"v":!0===f.relative?s+=f.y:s=f.y,t?c.lineTo(a,-s):c.lineTo(a,s);break;case"H":case"h":!0===f.relative?a+=f.x:a=f.x,t?c.lineTo(a,-s):c.lineTo(a,s);break;case"C":case"c":!0===f.relative?(n=a+f.x1,o=s+f.y1,i=a+f.x2,u=s+f.y2,a+=f.x,s+=f.y):(n=f.x1,o=f.y1,i=f.x2,u=f.y2,a=f.x,s=f.y),t?c.bezierCurveTo(n,-o,i,-u,a,-s):c.bezierCurveTo(n,o,i,u,a,s);break;case"S":case"s":n=a+(a-i),o=s+(s-u),!0===f.relative?(i=a+f.x2,u=s+f.y2,a+=f.x,s+=f.y):(i=f.x2,u=f.y2,a=f.x,s=f.y),t?c.bezierCurveTo(n,-o,i,-u,a,-s):c.bezierCurveTo(n,o,i,u,a,s);break;case"Q":case"q":!0===f.relative?(n=a+f.x1,o=s+f.y1,a+=f.x,s+=f.y):(n=f.x1,o=f.y1,a=f.x,s=f.y),t?c.quadraticCurveTo(n,-o,a,-s):c.quadraticCurveTo(n,o,a,s);break;case"T":case"t":n=a+(a-n),o=s+(s-o),!0===f.relative?(a+=f.x,s+=f.y):(a=f.x,s=f.y),t?c.quadraticCurveTo(n,-o,a,-s):c.quadraticCurveTo(n,o,a,s);break;case"A":case"a":throw new He;case"Z":c.closePath();break;default:throw new Error('Unknown code "'+f.code+'"')}return e},[]);return 0===f.length?null:1===f.length?f[0]:f.reduce(function(e,r){return e.add(r),e},new r.Shape)}},Ye=Object.assign({},t,n),$e=O.optional("topojson");function Xe(e){return e+"Code"}function Ke(e,r,t){var n=Xe(e);return t.properties[n]===r}function er(e,r){var t=e.reduce(function(e,r){return e.concat(r.x,r.y)},[]),n=e.length,o=[];r.forEach(function(e,r){o.push(n),n+=e.length,t=t.concat(e.reduce(function(e,r){return e.concat(r.x,r.y)},[]))});for(var i=ce(t,o,2),u=[],a=0;a<i.length;a+=3)u.push(i.slice(a,a+3));return u}function rr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.coordinates.reduce(function(e,o,i){var u=t.path({type:"Polygon",coordinates:o});if(!u)return n.push(i),e;var a=We.parse(u,!0),s=void 0;s=a instanceof r.Shape?a.curves:[a];var c=new r.Shape;return s.forEach(function(e){var r=We.winding(e.curves);"ccw"===r?c.add(e):"cw"===r&&c.holes.push(e)}),0===c.holes.length?e.concat(c.curves.map(function(e){var t=new r.Shape;return t.add(e),t})):e.concat(c)},[])}function tr(e){var t=new Float32Array(6*e.length);e.forEach(function(e,r){var n=6*r;t[n+0]=e.v1.x,t[n+1]=e.v1.y,t[n+3]=e.v2.x,t[n+4]=e.v2.y});var n=new r.BufferGeometry,o=new r.BufferAttribute(t,3);return n.addAttribute("position",o),n}var nr=i("GeographyBuilder"),or=function(){function e(r){s(this,e),nr(this).levels=[].concat(v(r))}return c(e,[{key:"init",value:function(){var e=a(regeneratorRuntime.mark(function e(r){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=nr(this),"string"!=typeof r){e.next=7;break}return e.next=4,K.json(r,{local:!0});case 4:t.data=e.sent,e.next=10;break;case 7:return e.next=9,Promise.resolve(r);case 9:t.data=e.sent;case 10:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"property",value:function(e,r){var t=r.level,n=r.code,o=r.projection,i=this.data.objects.geography.geometries;t&&(i=i.filter(function(e){return Ke(t,n,e)}));var u=$e.merge(this.data,i);return o?o.path[e](u):Ye["geo"+e.charAt().toUpperCase()+e.slice(1)](u)}},{key:"bounds",value:function(e){return this.property("bounds",e)}},{key:"area",value:function(e){return this.property("area",e)}},{key:"centroid",value:function(e){return this.property("centroid",e)}},{key:"poleOfInaccessibility",value:function(e){var t=e.level,n=e.code,o=e.projection,i=e.precision,u=void 0===i?.01:i,a=this.data.objects.geography.geometries;if(t&&(a=a.filter(function(e){return Ke(t,n,e)})),a=$e.merge(this.data,a),o){var s=Fe.max(a.coordinates,function(e){return o.path.area({type:"Polygon",coordinates:e})});if(!s)return console.warn("Unable to derive pole of inaccessibility:",t,n),null;var c=o.path({type:"Polygon",coordinates:s});if(!c)return console.warn("Unable to derive pole of inaccessibility:",t,n),null;var f=We.parse(c,!0);if(!f)return console.warn("Unable to derive pole of inaccessibility:",t,n),null;var l=(f instanceof r.Shape?f.curves:[f]).map(function(e){return e.curves.map(function(e){return[e.v1.x,e.v1.y]})});return Be(l,Math.sqrt(o.path.area({type:"Polygon",coordinates:s}))*u)}var h=Fe.max(a.coordinates,function(e){return Ye.geoArea({type:"Polygon",coordinates:e})});return h?Be(h,Math.sqrt(Ye.geoArea({type:"Polygon",coordinates:h}))*u):(console.warn("Unable to derive pole of inaccessibility:",t,n),null)}},{key:"shapes",value:function(e){var r=e.geometries,t=e.projection,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return rr($e.merge(this.data,r),t,n)}},{key:"shapeGeometry",value:function(e){var t=e.geometries,n=e.projection,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(e){var t=r.ShapeUtils.triangulateShape;r.ShapeUtils.triangulateShape=er;var n=(new r.BufferGeometry).fromGeometry(e.reduce(function(e,t){return e.merge(new r.ShapeGeometry(t)),e},new r.Geometry));return r.ShapeUtils.triangulateShape=t,n.computeBoundingSphere(),n}(rr($e.merge(this.data,t),n,o))}},{key:"outlineGeometry",value:function(e){var r=e.geometries,t=e.projection,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=rr($e.merge(this.data,r),t,n);return tr(o.reduce(function(e,r){return e.concat(r.curves.reduce(function(e,r){return e.concat(r.curves)},[]),r.holes.reduce(function(e,r){return e.concat(r.curves)},[]))},[]))}},{key:"borderGeometry",value:function(e){var t=e.object,n=e.filter,o=e.projection,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],u=$e.mesh(this.data,t,n),a=o.path(u);if(!a)return i.push(0),tr([]);var s=We.parse(a,!0);return tr(s instanceof r.Shape?s.curves.reduce(function(e,r){return e.concat(r.curves)},[]):s.curves)}},{key:"geographyShapes",value:function(e){var r=e.projection,t=this.data.objects.geography.geometries,n=[],o=this.shapes({projection:r,geometries:t},n);return 0!==n.length&&console.warn("Unable to project "+n.length+" polygons"),o}},{key:"geographyShapeGeometry",value:function(e){var r=e.projection,t=this.data.objects.geography.geometries,n=[],o=this.shapeGeometry({projection:r,geometries:t},n);return 0!==n.length&&console.warn("Unable to project "+n.length+" polygons"),o}},{key:"geographyOutlineGeometry",value:function(e){var r=e.projection,t=this.data.objects.geography.geometries,n=[],o=this.outlineGeometry({projection:r,geometries:t},n);return 0!==n.length&&console.warn("Unable to project "+n.length+" polygons"),o}},{key:"geographySubdivisionGeometry",value:function(e){var t=e.projection,n=Xe(this.levels[0]),o=[],i=this.borderGeometry({projection:t,object:this.data.objects.geography,filter:function(e,r){return e.properties[n]!==r.properties[n]}},o);return 0!==o.length?new r.BufferGeometry:i}},{key:"divisionShapes",value:function(e){var r=e.level,t=e.code,n=e.projection,o=this.data.objects.geography.geometries,i=[],u=this.shapes({projection:n,geometries:o.filter(function(e){return Ke(r,t,e)})},i);return 0!==i.length&&console.warn(i.length+" polygons failed to project"),u}},{key:"divisionShapeGeometry",value:function(e){var r=e.level,t=e.code,n=e.projection,o=this.data.objects.geography.geometries,i=[],u=this.shapeGeometry({projection:n,geometries:o.filter(function(e){return Ke(r,t,e)})},i);return 0!==i.length&&console.warn("Unable to project "+i.length+" polygons:",r,t),u}},{key:"divisionOutlineGeometry",value:function(e){var r=e.level,t=e.code,n=e.projection,o=this.data.objects.geography.geometries,i=[],u=this.outlineGeometry({projection:n,geometries:o.filter(function(e){return Ke(r,t,e)})},i);return 0!==i.length&&console.warn("Unable to project "+i.length+" polygons:",r,t),u}},{key:"divisionBorderGeometry",value:function(e){var t=this,n=e.level,o=e.code,i=e.projection,u=function(){var e=t.levels.indexOf(n);if(-1===e)throw new Error('Could not find level "'+n+'" in geography');if(e>0)return t.levels[e-1]}(),a=this.data.objects.geography.geometries;u&&(a=a.filter(function(e){return Ke(u,o,e)}));var s=a.filter(function(e){return Ke(n,o,e)}).map(function(e){return a.indexOf(e)}),c=$e.neighbors(a),f={type:"GeometryCollection",geometries:a.filter(function(e,r){return s.includes(r)||s.some(function(e){return c[e].includes(r)})})},l=Xe(n),h=[],p=this.borderGeometry({projection:i,object:f,filter:function(e,r){return e.properties[l]===o?e.properties[l]<r.properties[l]:e.properties[l]>r.properties[l]}},h);return 0!==h.length?new r.BufferGeometry:p}},{key:"divisionSubdivisionGeometry",value:function(e){var t=e.level,n=e.code,o=e.projection,i={type:"GeometryCollection",geometries:this.data.objects.geography.geometries.filter(function(e){return Ke(t,n,e)})},u=[],a=this.borderGeometry({projection:o,object:i,filter:function(e,r){return e!==r}},u);return 0!==u.length?new r.BufferGeometry:a}},{key:"levels",get:function(){var e=nr(this);return[].concat(v(e.levels))}},{key:"data",get:function(){return nr(this).data}}]),e}(),ir=function(e){function r(){return s(this,r),h(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,"japan",[new ue("prefecture"),new ue("municipality",{coerce:function(e){return parseInt(e,10)},super:function(e){return parseInt((""+e).slice(0,-3),10)}})]))}return l(r,se),r}();function ur(e,r){return{quotient:Math.floor(e/r),remainder:e%r}}function ar(e){var r=Math.floor(e);return{integral:r,fractional:e-r}}var sr={primary:function(e){var r=ur(60*e[1],40);return 100*r.quotient+1*(r=ar(e[0]-100)).integral},secondary:function(e){var r=ur(60*e[1],40),t=r.quotient,n=(r=ur(r.remainder,5)).quotient;return 1e4*t+100*(r=ar(e[0]-100)).integral+10*n+1*(r=ur(60*r.fractional,7.5)).quotient},basic:function(e){var r=ur(60*e[1],40),t=r.quotient,n=(r=ur(r.remainder,5)).quotient,o=(r=ur(60*r.remainder,30)).quotient;return 1e6*t+1e4*(r=ar(e[0]-100)).integral+1e3*n+100*(r=ur(60*r.fractional,7.5)).quotient+10*o+1*(r=ur(60*r.remainder,45)).quotient},half:function(e){var r=ur(60*e[1],40),t=r.quotient,n=(r=ur(r.remainder,5)).quotient,o=(r=ur(60*r.remainder,30)).quotient,i=(r=ur(r.remainder,15)).quotient;return 1e7*t+1e5*(r=ar(e[0]-100)).integral+1e4*n+1e3*(r=ur(60*r.fractional,7.5)).quotient+100*o+10*(r=ur(60*r.remainder,45)).quotient+1*(2*i+(r=ur(r.remainder,22.5)).quotient+1)},quarter:function(e){var r=ur(60*e[1],40),t=r.quotient,n=(r=ur(r.remainder,5)).quotient,o=(r=ur(60*r.remainder,30)).quotient,i=(r=ur(r.remainder,15)).quotient,u=(r=ur(r.remainder,7.5)).quotient;return 1e8*t+1e6*(r=ar(e[0]-100)).integral+1e5*n+1e4*(r=ur(60*r.fractional,7.5)).quotient+1e3*o+100*(r=ur(60*r.remainder,45)).quotient+10*(2*i+(r=ur(r.remainder,22.5)).quotient+1)+1*(2*u+(r=ur(r.remainder,11.25)).quotient+1)},eighth:function(e){var r=ur(60*e[1],40),t=r.quotient,n=(r=ur(r.remainder,5)).quotient,o=(r=ur(60*r.remainder,30)).quotient,i=(r=ur(r.remainder,15)).quotient,u=(r=ur(r.remainder,7.5)).quotient,a=(r=ur(r.remainder,3.75)).quotient;return 1e9*t+1e7*(r=ar(e[0]-100)).integral+1e6*n+1e5*(r=ur(60*r.fractional,7.5)).quotient+1e4*o+1e3*(r=ur(60*r.remainder,45)).quotient+100*(2*i+(r=ur(r.remainder,22.5)).quotient+1)+10*(2*u+(r=ur(r.remainder,11.25)).quotient+1)+1*(2*a+(r=ur(r.remainder,5.625)).quotient+1)}},cr={primary:function(e){var r=ur(e,100),t=r.quotient;return[3600*((r=ur(r.remainder,1)).quotient+100)/3600,2400*t/3600]},secondary:function(e){var r=ur(e,1e4),t=r.quotient,n=(r=ur(r.remainder,100)).quotient,o=(r=ur(r.remainder,10)).quotient;return[(3600*(n+100)+450*(r=ur(r.remainder,1)).quotient)/3600,(2400*t+300*o)/3600]},basic:function(e){var r=ur(e,1e6),t=r.quotient,n=(r=ur(r.remainder,1e4)).quotient,o=(r=ur(r.remainder,1e3)).quotient,i=(r=ur(r.remainder,100)).quotient,u=(r=ur(r.remainder,10)).quotient;return[(3600*(n+100)+450*i+45*(r=ur(r.remainder,1)).quotient)/3600,(2400*t+300*o+30*u)/3600]},half:function(e){var r=ur(e,1e7),t=r.quotient,n=(r=ur(r.remainder,1e5)).quotient,o=(r=ur(r.remainder,1e4)).quotient,i=(r=ur(r.remainder,1e3)).quotient,u=(r=ur(r.remainder,100)).quotient,a=(r=ur(r.remainder,10)).quotient,s=(r=ur(r.remainder,1)).quotient;return[(3600*(n+100)+450*i+45*a+22.5*(s-1&1))/3600,(2400*t+300*o+30*u+15*(s-1>>1))/3600]},quarter:function(e){var r=ur(e,1e8),t=r.quotient,n=(r=ur(r.remainder,1e6)).quotient,o=(r=ur(r.remainder,1e5)).quotient,i=(r=ur(r.remainder,1e4)).quotient,u=(r=ur(r.remainder,1e3)).quotient,a=(r=ur(r.remainder,100)).quotient,s=(r=ur(r.remainder,10)).quotient,c=(r=ur(r.remainder,1)).quotient;return[(3600*(n+100)+450*i+45*a+22.5*(s-1&1)+11.25*(c-1&1))/3600,(2400*t+300*o+30*u+15*(s-1>>1)+7.5*(c-1>>1))/3600]},eighth:function(e){var r=ur(e,1e9),t=r.quotient,n=(r=ur(r.remainder,1e7)).quotient,o=(r=ur(r.remainder,1e6)).quotient,i=(r=ur(r.remainder,1e5)).quotient,u=(r=ur(r.remainder,1e4)).quotient,a=(r=ur(r.remainder,1e3)).quotient,s=(r=ur(r.remainder,100)).quotient,c=(r=ur(r.remainder,10)).quotient,f=(r=ur(r.remainder,1)).quotient;return[(3600*(n+100)+450*i+45*a+22.5*(s-1&1)+11.25*(c-1&1)+5.625*(f-1&1))/3600,(2400*t+300*o+30*u+15*(s-1>>1)+7.5*(c-1>>1)+3.75*(f-1>>1))/3600]}},fr=i("JapanRegionalMesh"),lr=function(){function e(r,t){s(this,e);var n=fr(this);n.name=r,n.size=[].concat(v(t))}return c(e,[{key:"code",value:function(e){return sr[this.name](e)}},{key:"origin",value:function(e){return cr[this.name](e)}},{key:"center",value:function(e){var r=this.origin(e),t=this.size;return[r[0]+t[0]/2,r[1]+t[1]/2]}},{key:"name",get:function(){return fr(this).name}},{key:"size",get:function(){var e=fr(this);return[].concat(v(e.size))}}]),e}(),hr={primary:new lr("primary",[1,2400/3600]),secondary:new lr("secondary",[.125,300/3600]),basic:new lr("basic",[.0125,30/3600]),half:new lr("half",[.00625,15/3600]),quarter:new lr("quarter",[.003125,7.5/3600]),eighth:new lr("eighth",[.0015625,3.75/3600])},pr=m(function(e,r){!function(){var r=Math.PI,t=Math.sin,n=Math.cos,o=Math.tan,i=Math.asin,u=Math.atan2,a=Math.acos,s=r/180,c=864e5,f=2440588,l=2451545;function h(e){return new Date((e+.5-f)*c)}function p(e){return e.valueOf()/c-.5+f-l}var v=23.4397*s;function d(e,r){return u(t(e)*n(v)-o(r)*t(v),n(e))}function y(e,r){return i(t(r)*n(v)+n(r)*t(v)*t(e))}function g(e,r,i){return u(t(e),n(e)*t(r)-o(i)*n(r))}function m(e,r,o){return i(t(r)*t(o)+n(r)*n(o)*n(e))}function x(e,r){return s*(280.16+360.9856235*e)-r}function b(e){return s*(357.5291+.98560028*e)}function w(e){return e+s*(1.9148*t(e)+.02*t(2*e)+3e-4*t(3*e))+102.9372*s+r}function k(e){var r=w(b(e));return{dec:y(r,0),ra:d(r,0)}}var j={getPosition:function(e,r,t){var n=s*-t,o=s*r,i=p(e),u=k(i),a=x(i,n)-u.ra;return{azimuth:g(a,o,u.dec),altitude:m(a,o,u.dec)}}},q=j.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];j.addTime=function(e,r,t){q.push([e,r,t])};var A=9e-4;function O(e,t,n){return A+(e+t)/(2*r)+n}function S(e,r,n){return l+e+.0053*t(r)-.0069*t(2*n)}function C(e,r,o,i,u,s,c){var f,l;return S(O((f=o,l=i,a((t(e)-t(f)*t(l))/(n(f)*n(l)))),r,u),s,c)}function R(e){var r=s*(134.963+13.064993*e),o=s*(93.272+13.22935*e),i=s*(218.316+13.176396*e)+6.289*s*t(r),u=5.128*s*t(o),a=385001-20905*n(r);return{ra:d(i,u),dec:y(i,u),dist:a}}function E(e,r){return new Date(e.valueOf()+r*c/24)}j.getTimes=function(e,t,n){var o,i,u,a,c,f,l,v=s*-n,d=s*t,g=p(e),m=(f=g,l=v,Math.round(f-A-l/(2*r))),x=O(0,v,m),k=b(x),j=w(k),R=y(j,0),E=S(x,k,j),T={solarNoon:h(E),nadir:h(E-.5)};for(o=0,i=q.length;o<i;o+=1)c=E-((a=C((u=q[o])[0]*s,v,d,R,m,k,j))-E),T[u[1]]=h(c),T[u[2]]=h(a);return T},j.getMoonPosition=function(e,r,i){var a,c=s*-i,f=s*r,l=p(e),h=R(l),v=x(l,c)-h.ra,d=m(v,f,h.dec),y=u(t(v),o(f)*n(h.dec)-t(h.dec)*n(v));return d+=((a=d)<0&&(a=0),2967e-7/Math.tan(a+.00312536/(a+.08901179))),{azimuth:g(v,f,h.dec),altitude:d,distance:h.dist,parallacticAngle:y}},j.getMoonIllumination=function(e){var r=p(e||new Date),o=k(r),i=R(r),s=a(t(o.dec)*t(i.dec)+n(o.dec)*n(i.dec)*n(o.ra-i.ra)),c=u(149598e3*t(s),i.dist-149598e3*n(s)),f=u(n(o.dec)*t(o.ra-i.ra),t(o.dec)*n(i.dec)-n(o.dec)*t(i.dec)*n(o.ra-i.ra));return{fraction:(1+n(c))/2,phase:.5+.5*c*(f<0?-1:1)/Math.PI,angle:f}},j.getMoonTimes=function(e,r,t,n){var o=new Date(e);n?o.setUTCHours(0,0,0,0):o.setHours(0,0,0,0);for(var i,u,a,c,f,l,h,p,v,d,y,g,m,x=.133*s,b=j.getMoonPosition(o,r,t).altitude-x,w=1;w<=24&&(i=j.getMoonPosition(E(o,w),r,t).altitude-x,p=((f=(b+(u=j.getMoonPosition(E(o,w+1),r,t).altitude-x))/2-i)*(h=-(l=(u-b)/2)/(2*f))+l)*h+i,d=0,(v=l*l-4*f*i)>=0&&(y=h-(m=Math.sqrt(v)/(2*Math.abs(f))),g=h+m,Math.abs(y)<=1&&d++,Math.abs(g)<=1&&d++,y<-1&&(y=g)),1===d?b<0?a=w+y:c=w+y:2===d&&(a=w+(p<0?g:y),c=w+(p<0?y:g)),!a||!c);w+=2)b=u;var k={};return a&&(k.rise=E(o,a)),c&&(k.set=E(o,c)),a||c||(k[p>0?"alwaysUp":"alwaysDown"]=!0),k},e.exports=j}()}),vr=m(function(e){var r,t;r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={rotl:function(e,r){return e<<r|e>>>32-r},rotr:function(e,r){return e<<32-r|e>>>r},endian:function(e){if(e.constructor==Number)return 16711935&t.rotl(e,8)|4278255360&t.rotl(e,24);for(var r=0;r<e.length;r++)e[r]=t.endian(e[r]);return e},randomBytes:function(e){for(var r=[];e>0;e--)r.push(Math.floor(256*Math.random()));return r},bytesToWords:function(e){for(var r=[],t=0,n=0;t<e.length;t++,n+=8)r[n>>>5]|=e[t]<<24-n%32;return r},wordsToBytes:function(e){for(var r=[],t=0;t<32*e.length;t+=8)r.push(e[t>>>5]>>>24-t%32&255);return r},bytesToHex:function(e){for(var r=[],t=0;t<e.length;t++)r.push((e[t]>>>4).toString(16)),r.push((15&e[t]).toString(16));return r.join("")},hexToBytes:function(e){for(var r=[],t=0;t<e.length;t+=2)r.push(parseInt(e.substr(t,2),16));return r},bytesToBase64:function(e){for(var t=[],n=0;n<e.length;n+=3)for(var o=e[n]<<16|e[n+1]<<8|e[n+2],i=0;i<4;i++)8*n+6*i<=8*e.length?t.push(r.charAt(o>>>6*(3-i)&63)):t.push("=");return t.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var t=[],n=0,o=0;n<e.length;o=++n%4)0!=o&&t.push((r.indexOf(e.charAt(n-1))&Math.pow(2,-2*o+8)-1)<<2*o|r.indexOf(e.charAt(n))>>>6-2*o);return t}},e.exports=t}),dr={utf8:{stringToBytes:function(e){return dr.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(dr.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var r=[],t=0;t<e.length;t++)r.push(255&e.charCodeAt(t));return r},bytesToString:function(e){for(var r=[],t=0;t<e.length;t++)r.push(String.fromCharCode(e[t]));return r.join("")}}},yr=dr,gr=function(e){return null!=e&&(mr(e)||"function"==typeof(r=e).readFloatLE&&"function"==typeof r.slice&&mr(r.slice(0,0))||!!e._isBuffer);var r};function mr(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var xr,br,wr,kr,jr=m(function(e){var r,t,n,o,i;r=vr,t=yr.utf8,n=gr,o=yr.bin,(i=function e(i,u){i.constructor==String?i=u&&"binary"===u.encoding?o.stringToBytes(i):t.stringToBytes(i):n(i)?i=Array.prototype.slice.call(i,0):Array.isArray(i)||(i=i.toString());for(var a=r.bytesToWords(i),s=8*i.length,c=1732584193,f=-271733879,l=-1732584194,h=271733878,p=0;p<a.length;p++)a[p]=16711935&(a[p]<<8|a[p]>>>24)|4278255360&(a[p]<<24|a[p]>>>8);a[s>>>5]|=128<<s%32,a[14+(s+64>>>9<<4)]=s;var v=e._ff,d=e._gg,y=e._hh,g=e._ii;for(p=0;p<a.length;p+=16){var m=c,x=f,b=l,w=h;f=g(f=g(f=g(f=g(f=y(f=y(f=y(f=y(f=d(f=d(f=d(f=d(f=v(f=v(f=v(f=v(f,l=v(l,h=v(h,c=v(c,f,l,h,a[p+0],7,-680876936),f,l,a[p+1],12,-389564586),c,f,a[p+2],17,606105819),h,c,a[p+3],22,-1044525330),l=v(l,h=v(h,c=v(c,f,l,h,a[p+4],7,-176418897),f,l,a[p+5],12,1200080426),c,f,a[p+6],17,-1473231341),h,c,a[p+7],22,-45705983),l=v(l,h=v(h,c=v(c,f,l,h,a[p+8],7,1770035416),f,l,a[p+9],12,-1958414417),c,f,a[p+10],17,-42063),h,c,a[p+11],22,-1990404162),l=v(l,h=v(h,c=v(c,f,l,h,a[p+12],7,1804603682),f,l,a[p+13],12,-40341101),c,f,a[p+14],17,-1502002290),h,c,a[p+15],22,1236535329),l=d(l,h=d(h,c=d(c,f,l,h,a[p+1],5,-165796510),f,l,a[p+6],9,-1069501632),c,f,a[p+11],14,643717713),h,c,a[p+0],20,-373897302),l=d(l,h=d(h,c=d(c,f,l,h,a[p+5],5,-701558691),f,l,a[p+10],9,38016083),c,f,a[p+15],14,-660478335),h,c,a[p+4],20,-405537848),l=d(l,h=d(h,c=d(c,f,l,h,a[p+9],5,568446438),f,l,a[p+14],9,-1019803690),c,f,a[p+3],14,-187363961),h,c,a[p+8],20,1163531501),l=d(l,h=d(h,c=d(c,f,l,h,a[p+13],5,-1444681467),f,l,a[p+2],9,-51403784),c,f,a[p+7],14,1735328473),h,c,a[p+12],20,-1926607734),l=y(l,h=y(h,c=y(c,f,l,h,a[p+5],4,-378558),f,l,a[p+8],11,-2022574463),c,f,a[p+11],16,1839030562),h,c,a[p+14],23,-35309556),l=y(l,h=y(h,c=y(c,f,l,h,a[p+1],4,-1530992060),f,l,a[p+4],11,1272893353),c,f,a[p+7],16,-155497632),h,c,a[p+10],23,-1094730640),l=y(l,h=y(h,c=y(c,f,l,h,a[p+13],4,681279174),f,l,a[p+0],11,-358537222),c,f,a[p+3],16,-722521979),h,c,a[p+6],23,76029189),l=y(l,h=y(h,c=y(c,f,l,h,a[p+9],4,-640364487),f,l,a[p+12],11,-421815835),c,f,a[p+15],16,530742520),h,c,a[p+2],23,-995338651),l=g(l,h=g(h,c=g(c,f,l,h,a[p+0],6,-198630844),f,l,a[p+7],10,1126891415),c,f,a[p+14],15,-1416354905),h,c,a[p+5],21,-57434055),l=g(l,h=g(h,c=g(c,f,l,h,a[p+12],6,1700485571),f,l,a[p+3],10,-1894986606),c,f,a[p+10],15,-1051523),h,c,a[p+1],21,-2054922799),l=g(l,h=g(h,c=g(c,f,l,h,a[p+8],6,1873313359),f,l,a[p+15],10,-30611744),c,f,a[p+6],15,-1560198380),h,c,a[p+13],21,1309151649),l=g(l,h=g(h,c=g(c,f,l,h,a[p+4],6,-145523070),f,l,a[p+11],10,-1120210379),c,f,a[p+2],15,718787259),h,c,a[p+9],21,-343485551),c=c+m>>>0,f=f+x>>>0,l=l+b>>>0,h=h+w>>>0}return r.endian([c,f,l,h])})._ff=function(e,r,t,n,o,i,u){var a=e+(r&t|~r&n)+(o>>>0)+u;return(a<<i|a>>>32-i)+r},i._gg=function(e,r,t,n,o,i,u){var a=e+(r&n|t&~n)+(o>>>0)+u;return(a<<i|a>>>32-i)+r},i._hh=function(e,r,t,n,o,i,u){var a=e+(r^t^n)+(o>>>0)+u;return(a<<i|a>>>32-i)+r},i._ii=function(e,r,t,n,o,i,u){var a=e+(t^(r|~n))+(o>>>0)+u;return(a<<i|a>>>32-i)+r},i._blocksize=16,i._digestsize=16,e.exports=function(e,t){if(void 0===e||null===e)throw new Error("Illegal argument "+e);var n=r.wordsToBytes(i(e,t));return t&&t.asBytes?n:t&&t.asString?o.bytesToString(n):r.bytesToHex(n)}}),qr={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},Ar=function(e){throw{name:"SyntaxError",message:e,at:xr,text:wr}},Or=function(e){return e&&e!==br&&Ar("Expected '"+e+"' instead of '"+br+"'"),br=wr.charAt(xr),xr+=1,br},Sr=function(){var e,r="";for("-"===br&&(r="-",Or("-"));br>="0"&&br<="9";)r+=br,Or();if("."===br)for(r+=".";Or()&&br>="0"&&br<="9";)r+=br;if("e"===br||"E"===br)for(r+=br,Or(),"-"!==br&&"+"!==br||(r+=br,Or());br>="0"&&br<="9";)r+=br,Or();if(e=+r,isFinite(e))return e;Ar("Bad number")},Cr=function(){var e,r,t,n="";if('"'===br)for(;Or();){if('"'===br)return Or(),n;if("\\"===br)if(Or(),"u"===br){for(t=0,r=0;r<4&&(e=parseInt(Or(),16),isFinite(e));r+=1)t=16*t+e;n+=String.fromCharCode(t)}else{if("string"!=typeof qr[br])break;n+=qr[br]}else n+=br}Ar("Bad string")},Rr=function(){for(;br&&br<=" ";)Or()};kr=function(){switch(Rr(),br){case"{":return function(){var e,r={};if("{"===br){if(Or("{"),Rr(),"}"===br)return Or("}"),r;for(;br;){if(e=Cr(),Rr(),Or(":"),Object.hasOwnProperty.call(r,e)&&Ar('Duplicate key "'+e+'"'),r[e]=kr(),Rr(),"}"===br)return Or("}"),r;Or(","),Rr()}}Ar("Bad object")}();case"[":return function(){var e=[];if("["===br){if(Or("["),Rr(),"]"===br)return Or("]"),e;for(;br;){if(e.push(kr()),Rr(),"]"===br)return Or("]"),e;Or(","),Rr()}}Ar("Bad array")}();case'"':return Cr();case"-":return Sr();default:return br>="0"&&br<="9"?Sr():function(){switch(br){case"t":return Or("t"),Or("r"),Or("u"),Or("e"),!0;case"f":return Or("f"),Or("a"),Or("l"),Or("s"),Or("e"),!1;case"n":return Or("n"),Or("u"),Or("l"),Or("l"),null}Ar("Unexpected '"+br+"'")}()}};var Er,Tr,Gr,Mr=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,Pr={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function Nr(e){return Mr.lastIndex=0,Mr.test(e)?'"'+e.replace(Mr,function(e){var r=Pr[e];return"string"==typeof r?r:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}var Br="undefined"!=typeof JSON?JSON:{parse:function(e,r){var t;return wr=e,xr=0,br=" ",t=kr(),Rr(),br&&Ar("Syntax error"),"function"==typeof r?function e(t,n){var o,i,a=t[n];if(a&&"object"===(void 0===a?"undefined":u(a)))for(o in a)Object.prototype.hasOwnProperty.call(a,o)&&(void 0!==(i=e(a,o))?a[o]=i:delete a[o]);return r.call(t,n,a)}({"":t},""):t},stringify:function(e,r,t){var n;if(Er="",Tr="","number"==typeof t)for(n=0;n<t;n+=1)Tr+=" ";else"string"==typeof t&&(Tr=t);if(Gr=r,r&&"function"!=typeof r&&("object"!==(void 0===r?"undefined":u(r))||"number"!=typeof r.length))throw new Error("JSON.stringify");return function e(r,t){var n,o,i,a,s,c=Er,f=t[r];switch(f&&"object"===(void 0===f?"undefined":u(f))&&"function"==typeof f.toJSON&&(f=f.toJSON(r)),"function"==typeof Gr&&(f=Gr.call(t,r,f)),void 0===f?"undefined":u(f)){case"string":return Nr(f);case"number":return isFinite(f)?String(f):"null";case"boolean":case"null":return String(f);case"object":if(!f)return"null";if(Er+=Tr,s=[],"[object Array]"===Object.prototype.toString.apply(f)){for(a=f.length,n=0;n<a;n+=1)s[n]=e(n,f)||"null";return i=0===s.length?"[]":Er?"[\n"+Er+s.join(",\n"+Er)+"\n"+c+"]":"["+s.join(",")+"]",Er=c,i}if(Gr&&"object"===(void 0===Gr?"undefined":u(Gr)))for(a=Gr.length,n=0;n<a;n+=1)"string"==typeof(o=Gr[n])&&(i=e(o,f))&&s.push(Nr(o)+(Er?": ":":")+i);else for(o in f)Object.prototype.hasOwnProperty.call(f,o)&&(i=e(o,f))&&s.push(Nr(o)+(Er?": ":":")+i);return i=0===s.length?"{}":Er?"{\n"+Er+s.join(",\n"+Er)+"\n"+c+"}":"{"+s.join(",")+"}",Er=c,i}}("",{"":e})}},_r=function(e,r){r||(r={}),"function"==typeof r&&(r={cmp:r});var t=r.space||"";"number"==typeof t&&(t=Array(t+1).join(" "));var n,o="boolean"==typeof r.cycles&&r.cycles,i=r.replacer||function(e,r){return r},a=r.cmp&&(n=r.cmp,function(e){return function(r,t){var o={key:r,value:e[r]},i={key:t,value:e[t]};return n(o,i)}}),s=[];return function e(r,n,c,f){var l=t?"\n"+new Array(f+1).join(t):"",h=t?": ":":";if(c&&c.toJSON&&"function"==typeof c.toJSON&&(c=c.toJSON()),void 0!==(c=i.call(r,n,c))){if("object"!==(void 0===c?"undefined":u(c))||null===c)return Br.stringify(c);if(zr(c)){for(var p=[],v=0;v<c.length;v++){var d=e(c,v,c[v],f+1)||Br.stringify(null);p.push(l+t+d)}return"["+p.join(",")+l+"]"}if(-1!==s.indexOf(c)){if(o)return Br.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}s.push(c);var y=Zr(c).sort(a&&a(c));for(p=[],v=0;v<y.length;v++){var g=e(c,n=y[v],c[n],f+1);if(g){var m=Br.stringify(n)+h+g;p.push(l+t+m)}}return s.splice(s.indexOf(c),1),"{"+p.join(",")+l+"}"}}({"":e},"",e,0)},zr=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},Zr=Object.keys||function(e){var r=Object.prototype.hasOwnProperty||function(){return!0},t=[];for(var n in e)r.call(e,n)&&t.push(n);return t};var Ir=Object.assign({},t,n,o),Ur=i("Projection"),Fr=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=r.name,n=void 0===t?"Equirectangular":t,o=r.scale,i=void 0===o?1e4:o,u=r.origin,a=void 0===u?[0,0]:u,c=r.rotates,f=void 0===c?[!0,!0]:c;s(this,e);var l=Ur(this);l.name=n,l.scale=+i||1,Array.isArray(a)?l.origin=[+a[0]||0,+a[1]||0]:l.origin=[+a||0,+a||0],Array.isArray(f)?l.rotates=[!!f[0],!!f[1]]:l.rotates=[!!f,!!f],l.projector=this.projector}return c(e,[{key:"project",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=Ur(this).projector(e);if(Number.isNaN(t[0])||Number.isNaN(t[1]))throw new Error("Could not project point ["+e+"]");return r&&(t[1]=-t[1]||0),t}},{key:"unproject",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=Ur(this).projector.invert([e[0],r?-e[1]||0:e[1]]);if(Number.isNaN(t[0])||Number.isNaN(t[1]))throw new Error("Could not unproject point ["+e+"]");return t}},{key:"sun",value:function(e){var r=this.origin;return pr.getPosition(e,r[1],r[0])}},{key:"moon",value:function(e){var r=this.origin;return pr.getMoonPosition(e,r[1],r[0])}},{key:"equals",value:function(e){return this.name===e.name&&this.scale===e.scale&&this.origin[0]===e.origin[0]&&this.origin[1]===e.origin[1]&&this.rotates[0]===e.rotates[0]&&this.rotates[1]===e.rotates[1]}},{key:"toJSON",value:function(){return{name:this.name,scale:this.scale,origin:this.origin,rotates:this.rotates}}},{key:"projector",get:function(){var e=Ir["geo"+this.name];if(void 0===e)throw new Error('Could not find projection for name "'+this.name+'"');var r=e();if("function"==typeof r.rotate){var t=[0,0,0];this.rotates[0]&&(t[0]=-this.origin[0]),this.rotates[1]&&(t[1]=-this.origin[1]),r.rotate(t)}r.translate([0,0]),r.scale(this.scale);var n=r(this.origin);return Array.isArray(n)&&r.translate([-n[0],-n[1]]),r}},{key:"path",get:function(){var e=Ur(this);return Ir.geoPath().projection(e.projector)}},{key:"name",get:function(){return Ur(this).name}},{key:"scale",get:function(){return Ur(this).scale}},{key:"origin",get:function(){var e=Ur(this);return[].concat(v(e.origin))}},{key:"rotates",get:function(){var e=Ur(this);return[].concat(v(e.rotates))}},{key:"hash",get:function(){var e,r=Ur(this);return void 0===r.hash&&(r.hash=(e=this.toJSON(),jr(_r(e)))),r.hash}}]),e}(),Jr=function(e){function r(){return s(this,r),h(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,"us",[new ue("state"),new ue("county",{coerce:function(e){return parseInt(e,10)},super:function(e){return parseInt((""+e).slice(0,-3),10)}})]))}return l(r,se),r}(),Lr=function(e){function r(){return s(this,r),h(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,"world",[new ue("country")]))}return l(r,se),r}();e.Division=y,e.DivisionLevel=ue,e.Geography=se,e.GeographyBuilder=or,e.GeometryPack=oe,e.JapanGeography=ir,e.JapanRegionalMesh=hr,e.Path=We,e.Projection=Fr,e.USGeography=Jr,e.WorldGeography=Lr,Object.defineProperty(e,"__esModule",{value:!0})});