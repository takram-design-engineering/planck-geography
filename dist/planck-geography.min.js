!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("three"),require("d3-array"),require("d3-geo"),require("d3-geo-projection")):"function"==typeof define&&define.amd?define(["exports","three","d3-array","d3-geo","d3-geo-projection"],r):r(e.Planck=e.Planck||{},e.THREE,e.d3,e.d3,e.d3)}(this,function(e,r,t,n,o){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,r=Symbol(e);return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return void 0===e[r]&&(e[r]=t({})),e[r]}}function u(e,r){return r={exports:{}},e(r,r.exports),r.exports}function a(e){var r=void 0,t=void 0;if("string"==typeof e?(t=e,r=e):r=e[t=Object.keys(e)[0]],process.browser)return Je.self[r];if("node"===Je.type)try{return require(t)}catch(e){}}function s(e){try{return a(e)}catch(e){Je.self.process={browser:"node"!==Je.type}}return a(e)}function c(){switch(Je.type){case"browser":var e=document.currentScript||document._currentScript;return e&&e.src||void 0;case"worker":return self.location.href;case"node":return __filename}}function f(e){return new Function("d","return {"+e.map(function(e,r){return JSON.stringify(e)+": d["+r+"]"}).join(",")+"}")}function l(e,r){var t=f(e);return function(n,o){return r(t(n),o,e)}}function h(e){var r=Object.create(null),t=[];return e.forEach(function(e){for(var n in e)n in r||t.push(r[n]=n)}),t}function p(e){return decodeURIComponent(e.replace(/\+/g," "))}function v(e){var r,t={},n=void 0===(e=e||Ze.location||{})?"undefined":Oe(e);if("blob:"===e.protocol)t=new g(unescape(e.pathname),{});else if("string"===n){t=new g(e,{});for(r in cr)delete t[r]}else if("object"===n){for(r in e)r in cr||(t[r]=e[r]);void 0===t.slashes&&(t.slashes=ar.test(e.href))}return t}function d(e){var r=ur.exec(e);return{protocol:r[1]?r[1].toLowerCase():"",slashes:!!r[2],rest:r[3]}}function y(e,r){for(var t=(r||"/").split("/").slice(0,-1).concat(e.split("/")),n=t.length,o=t[n-1],i=!1,u=0;n--;)"."===t[n]?t.splice(n,1):".."===t[n]?(t.splice(n,1),u++):u&&(0===n&&(i=!0),t.splice(n,1),u--);return i&&t.unshift(""),"."!==o&&".."!==o||t.push(""),t.join("/")}function g(e,r,t){if(!(this instanceof g))return new g(e,r,t);var n,o,i,u,a,s,c=sr.slice(),f=void 0===r?"undefined":Oe(r),l=this,h=0;for("object"!==f&&"string"!==f&&(t=r,r=null),t&&"function"!=typeof t&&(t=ir.parse),r=v(r),n=!(o=d(e||"")).protocol&&!o.slashes,l.slashes=o.slashes||n&&r.slashes,l.protocol=o.protocol||r.protocol||"",e=o.rest,o.slashes||(c[2]=[/(.*)/,"pathname"]);h<c.length;h++)i=(u=c[h])[0],s=u[1],i!==i?l[s]=e:"string"==typeof i?~(a=e.indexOf(i))&&("number"==typeof u[2]?(l[s]=e.slice(0,a),e=e.slice(a+u[2])):(l[s]=e.slice(a),e=e.slice(0,a))):(a=i.exec(e))&&(l[s]=a[1],e=e.slice(0,a.index)),l[s]=l[s]||(n&&u[3]?r[s]||"":""),u[4]&&(l[s]=l[s].toLowerCase());t&&(l.query=t(l.query)),n&&r.slashes&&"/"!==l.pathname.charAt(0)&&(""!==l.pathname||""!==r.pathname)&&(l.pathname=y(l.pathname,r.pathname)),nr(l.port,l.protocol)||(l.host=l.hostname,l.port=""),l.username=l.password="",l.auth&&(u=l.auth.split(":"),l.username=u[0]||"",l.password=u[1]||""),l.origin=l.protocol&&l.host&&"file:"!==l.protocol?l.protocol+"//"+l.host:"null",l.href=l.toString()}function m(e,r){return new Promise(function(t,n){var o=new fr(e,!0);r.query&&o.set("query",Object.assign({},o.query,r.query));var i=new XMLHttpRequest;if(i.open("get",o.toString(),!0),r.headers)for(var u=Object.keys(r.headers),a=0;a<u.length;++a)i.setRequestHeader.apply(i,Ne(r.headers[u[a]]));i.responseType=r.type,i.addEventListener("loadend",function(e){i.status<200||i.status>=300?n(i.status):null!==i.response||"json"!==r.type?t(i.response):n(new Error("Could not parse JSON"))},!1),i.send()})}function x(e,r){return r.local?new Promise(function(t,n){lr(e,r.encoding,function(e,r){e?n(e):t(r)})}):new Promise(function(t,n){hr({url:e,headers:r.headers||{},qs:r.query||{},encoding:r.encoding},function(e,r){e?n(e):((r.statusCode<200||r.statusCode>=300)&&n(r.statusCode),t(r.body))})})}function b(e,r){if("node"===Je.type){var t=x(e,r);return"json"===r.type?t.then(function(e){if("string"!=typeof e)throw new Error("Response is unexpectedly not a string");return JSON.parse(e)}):"arraybuffer"===r.type?t.then(function(e){if(!(e instanceof Buffer))throw new Error("Response is unexpectedly not a buffer");return new ArrayBuffer(e.length)}):t}return m(e,r)}function w(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];var n=r[0],o=r[1];if("string"!=typeof n&&(n=(o=n).url),"string"!=typeof n)throw new Error("The first argument or options.url must be a string");return o=Object.assign({},{type:"text",local:!1,encoding:"utf-8"},o),[n,o]}function k(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=e.toJSON(),n=t.data||{},o=[],i=r;if(n.index){var u=e.index.array,a=u.buffer;o.push([a,i]),n.index.array=[i,u.length],i+=a.byteLength}if(n.attributes)for(var s=Object.keys(n.attributes),c=0;c<s.length;++c){var f=s[c],l=e.attributes[f].array,h=l.buffer;o.push([h,i]),n.attributes[f].array=[i,l.length],i+=h.byteLength}return t.data=n,[t,o,i]}function j(e){if(Array.isArray(e)){for(var r=[],t=[],n=0,o=0;o<e.length;++o){var i=k(e[o],n),u=_e(i,3),a=u[0],s=u[1],c=u[2];r.push(a),t.push.apply(t,Ne(s)),n=c}return[r,t,n]}for(var f={},l=[],h=0,p=Object.keys(e),v=0;v<p.length;++v){var d=p[v],y=k(e[d],h),g=_e(y,3),a=g[0],s=g[1],c=g[2];f[d]=a,l.push.apply(l,Ne(s)),h=c}return[f,l,h]}function q(e,t){var n=Ge({},e,{data:Ge({},e.data)});if(n.data.index){var o=n.data.index.type,i=new(Function.prototype.bind.apply(Je.self[o],[null].concat([t],Ne(n.data.index.array))));n.data.index=Ge({},n.data.index,{array:i})}if(n.data.attributes){for(var u={},a=Object.keys(n.data.attributes),s=0;s<a.length;++s){var c=a[s],f=n.data.attributes[c],l=f.type,h=new(Function.prototype.bind.apply(Je.self[l],[null].concat([t],Ne(f.array))));u[c]=Ge({},f,{array:h})}n.data.attributes=u}return(new r.BufferGeometryLoader).parse(n)}function A(e,r){for(var t=new ArrayBuffer(r),n=new Uint8Array(t),o=0;o<e.length;++o){var i=_e(e[o],2),u=i[0],a=i[1];n.set(new Uint8Array(u),a)}return t}function S(e,r,t){t=t||2;var n=r&&r.length,o=n?r[0]*t:e.length,i=O(e,0,o,t,!0),u=[];if(!i)return u;var a,s,c,f,l,h,p;if(n&&(i=M(e,r,i,t)),e.length>80*t){a=c=e[0],s=f=e[1];for(var v=t;v<o;v+=t)l=e[v],h=e[v+1],l<a&&(a=l),h<s&&(s=h),l>c&&(c=l),h>f&&(f=h);p=Math.max(c-a,f-s)}return C(i,u,t,a,s,p),u}function O(e,r,t,n,o){var i,u;if(o===ee(e,r,t,n)>0)for(i=r;i<t;i+=n)u=$(i,e[i],e[i+1],u);else for(i=t-n;i>=r;i-=n)u=$(i,e[i],e[i+1],u);return u&&D(u,u.next)&&(X(u),u=u.next),u}function R(e,r){if(!e)return e;r||(r=e);var t,n=e;do{if(t=!1,n.steiner||!D(n,n.next)&&0!==L(n.prev,n,n.next))n=n.next;else{if(X(n),(n=r=n.prev)===n.next)return null;t=!0}}while(t||n!==r);return r}function C(e,r,t,n,o,i,u){if(e){!u&&i&&I(e,n,o,i);for(var a,s,c=e;e.prev!==e.next;)if(a=e.prev,s=e.next,i?T(e,n,o,i):E(e))r.push(a.i/t),r.push(e.i/t),r.push(s.i/t),X(e),e=s.next,c=s.next;else if((e=s)===c){u?1===u?C(e=G(e,r,t),r,t,n,o,i,2):2===u&&P(e,r,t,n,o,i):C(R(e),r,t,n,o,i,1);break}}}function E(e){var r=e.prev,t=e,n=e.next;if(L(r,t,n)>=0)return!1;for(var o=e.next.next;o!==e.prev;){if(F(r.x,r.y,t.x,t.y,n.x,n.y,o.x,o.y)&&L(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function T(e,r,t,n){var o=e.prev,i=e,u=e.next;if(L(o,i,u)>=0)return!1;for(var a=o.x<i.x?o.x<u.x?o.x:u.x:i.x<u.x?i.x:u.x,s=o.y<i.y?o.y<u.y?o.y:u.y:i.y<u.y?i.y:u.y,c=o.x>i.x?o.x>u.x?o.x:u.x:i.x>u.x?i.x:u.x,f=o.y>i.y?o.y>u.y?o.y:u.y:i.y>u.y?i.y:u.y,l=z(a,s,r,t,n),h=z(c,f,r,t,n),p=e.nextZ;p&&p.z<=h;){if(p!==e.prev&&p!==e.next&&F(o.x,o.y,i.x,i.y,u.x,u.y,p.x,p.y)&&L(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=e.prevZ;p&&p.z>=l;){if(p!==e.prev&&p!==e.next&&F(o.x,o.y,i.x,i.y,u.x,u.y,p.x,p.y)&&L(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function G(e,r,t){var n=e;do{var o=n.prev,i=n.next.next;!D(o,i)&&H(o,n,n.next,i)&&Q(o,i)&&Q(i,o)&&(r.push(o.i/t),r.push(n.i/t),r.push(i.i/t),X(n),X(n.next),n=e=i),n=n.next}while(n!==e);return n}function P(e,r,t,n,o,i){var u=e;do{for(var a=u.next.next;a!==u.prev;){if(u.i!==a.i&&J(u,a)){var s=Y(u,a);return u=R(u,u.next),s=R(s,s.next),C(u,r,t,n,o,i),void C(s,r,t,n,o,i)}a=a.next}u=u.next}while(u!==e)}function M(e,r,t,n){var o,i,u,a=[];for(o=0,i=r.length;o<i;o++)(u=O(e,r[o]*n,o<i-1?r[o+1]*n:e.length,n,!1))===u.next&&(u.steiner=!0),a.push(U(u));for(a.sort(_),o=0;o<a.length;o++)N(a[o],t),t=R(t,t.next);return t}function _(e,r){return e.x-r.x}function N(e,r){if(r=B(e,r)){var t=Y(r,e);R(t,t.next)}}function B(e,r){var t,n=r,o=e.x,i=e.y,u=-1/0;do{if(i<=n.y&&i>=n.next.y){var a=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=o&&a>u){if(u=a,a===o){if(i===n.y)return n;if(i===n.next.y)return n.next}t=n.x<n.next.x?n:n.next}}n=n.next}while(n!==r);if(!t)return null;if(o===u)return t.prev;var s,c=t,f=t.x,l=t.y,h=1/0;for(n=t.next;n!==c;)o>=n.x&&n.x>=f&&F(i<l?o:u,i,f,l,i<l?u:o,i,n.x,n.y)&&((s=Math.abs(i-n.y)/(o-n.x))<h||s===h&&n.x>t.x)&&Q(n,e)&&(t=n,h=s),n=n.next;return t}function I(e,r,t,n){var o=e;do{null===o.z&&(o.z=z(o.x,o.y,r,t,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,Z(o)}function Z(e){var r,t,n,o,i,u,a,s,c=1;do{for(t=e,e=null,i=null,u=0;t;){for(u++,n=t,a=0,r=0;r<c&&(a++,n=n.nextZ);r++);for(s=c;a>0||s>0&&n;)0===a?(o=n,n=n.nextZ,s--):0!==s&&n?t.z<=n.z?(o=t,t=t.nextZ,a--):(o=n,n=n.nextZ,s--):(o=t,t=t.nextZ,a--),i?i.nextZ=o:e=o,o.prevZ=i,i=o;t=n}i.nextZ=null,c*=2}while(u>1);return e}function z(e,r,t,n,o){return e=32767*(e-t)/o,r=32767*(r-n)/o,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),r=16711935&(r|r<<8),r=252645135&(r|r<<4),r=858993459&(r|r<<2),r=1431655765&(r|r<<1),e|r<<1}function U(e){var r=e,t=e;do{r.x<t.x&&(t=r),r=r.next}while(r!==e);return t}function F(e,r,t,n,o,i,u,a){return(o-u)*(r-a)-(e-u)*(i-a)>=0&&(e-u)*(n-a)-(t-u)*(r-a)>=0&&(t-u)*(i-a)-(o-u)*(n-a)>=0}function J(e,r){return e.next.i!==r.i&&e.prev.i!==r.i&&!V(e,r)&&Q(e,r)&&Q(r,e)&&W(e,r)}function L(e,r,t){return(r.y-e.y)*(t.x-r.x)-(r.x-e.x)*(t.y-r.y)}function D(e,r){return e.x===r.x&&e.y===r.y}function H(e,r,t,n){return!!(D(e,r)&&D(t,n)||D(e,n)&&D(t,r))||L(e,r,t)>0!=L(e,r,n)>0&&L(t,n,e)>0!=L(t,n,r)>0}function V(e,r){var t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==r.i&&t.next.i!==r.i&&H(t,t.next,e,r))return!0;t=t.next}while(t!==e);return!1}function Q(e,r){return L(e.prev,e,e.next)<0?L(e,r,e.next)>=0&&L(e,e.prev,r)>=0:L(e,r,e.prev)<0||L(e,e.next,r)<0}function W(e,r){var t=e,n=!1,o=(e.x+r.x)/2,i=(e.y+r.y)/2;do{t.y>i!=t.next.y>i&&o<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next}while(t!==e);return n}function Y(e,r){var t=new K(e.i,e.x,e.y),n=new K(r.i,r.x,r.y),o=e.next,i=r.prev;return e.next=r,r.prev=e,t.next=o,o.prev=t,n.next=t,t.prev=n,i.next=n,n.prev=i,n}function $(e,r,t,n){var o=new K(e,r,t);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function X(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function K(e,r,t){this.i=e,this.x=r,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ee(e,r,t,n){for(var o=0,i=r,u=t-n;i<t;i+=n)o+=(e[u]-e[i])*(e[i+1]+e[u+1]),u=i;return o}function re(e,r){if(!(this instanceof re))return new re(e,r);if(this.data=e||[],this.length=this.data.length,this.compare=r||te,this.length>0)for(var t=this.length>>1;t>=0;t--)this._down(t)}function te(e,r){return e<r?-1:e>r?1:0}function ne(e,r,t){r=r||1;for(var n,o,i,u,a=0;a<e[0].length;a++){var s=e[0][a];(!a||s[0]<n)&&(n=s[0]),(!a||s[1]<o)&&(o=s[1]),(!a||s[0]>i)&&(i=s[0]),(!a||s[1]>u)&&(u=s[1])}var c=i-n,f=u-o,l=Math.min(c,f),h=l/2,p=new br(null,oe);if(0===l)return[n,o];for(var v=n;v<i;v+=l)for(var d=o;d<u;d+=l)p.push(new ie(v+h,d+h,h,e));var y=ae(e),g=new ie(n+c/2,o+f/2,0,e);g.d>y.d&&(y=g);for(var m=p.length;p.length;){var x=p.pop();x.d>y.d&&(y=x,t&&console.log("found best %d after %d probes",Math.round(1e4*x.d)/1e4,m)),x.max-y.d<=r||(h=x.h/2,p.push(new ie(x.x-h,x.y-h,h,e)),p.push(new ie(x.x+h,x.y-h,h,e)),p.push(new ie(x.x-h,x.y+h,h,e)),p.push(new ie(x.x+h,x.y+h,h,e)),m+=4)}return t&&(console.log("num probes: "+m),console.log("best distance: "+y.d)),[y.x,y.y]}function oe(e,r){return r.max-e.max}function ie(e,r,t,n){this.x=e,this.y=r,this.h=t,this.d=ue(e,r,n),this.max=this.d+this.h*Math.SQRT2}function ue(e,r,t){for(var n=!1,o=1/0,i=0;i<t.length;i++)for(var u=t[i],a=0,s=u.length,c=s-1;a<s;c=a++){var f=u[a],l=u[c];f[1]>r!=l[1]>r&&e<(l[0]-f[0])*(r-f[1])/(l[1]-f[1])+f[0]&&(n=!n),o=Math.min(o,se(e,r,f,l))}return(n?1:-1)*Math.sqrt(o)}function ae(e){for(var r=0,t=0,n=0,o=e[0],i=0,u=o.length,a=u-1;i<u;a=i++){var s=o[i],c=o[a],f=s[0]*c[1]-c[0]*s[1];t+=(s[0]+c[0])*f,n+=(s[1]+c[1])*f,r+=3*f}return 0===r?new ie(o[0][0],o[0][1],0,e):new ie(t/r,n/r,0,e)}function se(e,r,t,n){var o=t[0],i=t[1],u=n[0]-o,a=n[1]-i;if(0!==u||0!==a){var s=((e-o)*u+(r-i)*a)/(u*u+a*a);s>1?(o=n[0],i=n[1]):s>0&&(o+=u*s,i+=a*s)}return u=e-o,a=r-i,u*u+a*a}function ce(e,r,t,n){this.message=e,this.expected=r,this.found=t,this.location=n,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,ce)}function fe(e){this.message=e}function le(e,r){return e.x*r.y-e.y*r.x}function he(e,r,t){if(e.x<t.x&&t.x<=r.x||r.x<t.x&&t.x<=e.x){var n=e.y;if(e.x!==r.x&&(n=e.y+(r.y-e.y)*(t.x-e.x)/(r.x-e.x)),t.y>n)return 1}return 0}function pe(e){return e+"Code"}function ve(e,r,t){var n=pe(e);return t.properties[n]===r}function de(e,r){var t=e.reduce(function(e,r){return e.concat(r.x,r.y)},[]),n=e.length,o=[];r.forEach(function(e,r){o.push(n),n+=e.length,t=t.concat(e.reduce(function(e,r){return e.concat(r.x,r.y)},[]))});for(var i=xr(t,o,2),u=[],a=0;a<i.length;a+=3)u.push(i.slice(a,a+3));return u}function ye(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.coordinates.reduce(function(e,o,i){var u=t.path({type:"Polygon",coordinates:o});if(!u)return n.push(i),e;var a=Er.parse(u,!0),s=void 0;s=a instanceof r.Shape?a.curves:[a];var c=new r.Shape;return s.forEach(function(e){var r=Er.winding(e.curves);"ccw"===r?c.add(e):"cw"===r&&c.holes.push(e)}),0===c.holes.length?e.concat(c.curves.map(function(e){var t=new r.Shape;return t.add(e),t})):e.concat(c)},[])}function ge(e){var t=r.ShapeUtils.triangulateShape;r.ShapeUtils.triangulateShape=de;var n=(new r.BufferGeometry).fromGeometry(e.reduce(function(e,t){return e.merge(new r.ShapeGeometry(t)),e},new r.Geometry));return r.ShapeUtils.triangulateShape=t,n.computeBoundingSphere(),n}function me(e){var t=new Float32Array(6*e.length);e.forEach(function(e,r){var n=6*r;t[n+0]=e.v1.x,t[n+1]=e.v1.y,t[n+3]=e.v2.x,t[n+4]=e.v2.y});var n=new r.BufferGeometry,o=new r.BufferAttribute(t,3);return n.addAttribute("position",o),n}function xe(e){return me(e.reduce(function(e,r){return e.concat(r.curves.reduce(function(e,r){return e.concat(r.curves)},[]),r.holes.reduce(function(e,r){return e.concat(r.curves)},[]))},[]))}function be(e,r){return{quotient:Math.floor(e/r),remainder:e%r}}function we(e){var r=Math.floor(e);return{integral:r,fractional:e-r}}function ke(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function je(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&ke(e.slice(0,0))}function qe(e){return it.lastIndex=0,it.test(e)?'"'+e.replace(it,function(e){var r=ut[e];return"string"==typeof r?r:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function Ae(e,r){var t,n,o,i,u,a=tt,s=r[e];switch(s&&"object"===(void 0===s?"undefined":Oe(s))&&"function"==typeof s.toJSON&&(s=s.toJSON(e)),"function"==typeof ot&&(s=ot.call(r,e,s)),void 0===s?"undefined":Oe(s)){case"string":return qe(s);case"number":return isFinite(s)?String(s):"null";case"boolean":case"null":return String(s);case"object":if(!s)return"null";if(tt+=nt,u=[],"[object Array]"===Object.prototype.toString.apply(s)){for(i=s.length,t=0;t<i;t+=1)u[t]=Ae(t,s)||"null";return o=0===u.length?"[]":tt?"[\n"+tt+u.join(",\n"+tt)+"\n"+a+"]":"["+u.join(",")+"]",tt=a,o}if(ot&&"object"===(void 0===ot?"undefined":Oe(ot)))for(i=ot.length,t=0;t<i;t+=1)"string"==typeof(n=ot[t])&&(o=Ae(n,s))&&u.push(qe(n)+(tt?": ":":")+o);else for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(o=Ae(n,s))&&u.push(qe(n)+(tt?": ":":")+o);return o=0===u.length?"{}":tt?"{\n"+tt+u.join(",\n"+tt)+"\n"+a+"}":"{"+u.join(",")+"}",tt=a,o}}function Se(e){return Hr(ct(e))}var Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Re=(function(){function e(e){this.value=e}function r(r){function t(o,i){try{var u=r[o](i),a=u.value;a instanceof e?Promise.resolve(a.value).then(function(e){t("next",e)},function(e){t("throw",e)}):n(u.done?"return":"normal",u.value)}catch(e){n("throw",e)}}function n(e,r){switch(e){case"return":o.resolve({value:r,done:!0});break;case"throw":o.reject(r);break;default:o.resolve({value:r,done:!1})}(o=o.next)?t(o.key,o.arg):i=null}var o,i;this._invoke=function(e,r){return new Promise(function(n,u){var a={key:e,arg:r,resolve:n,reject:u,next:null};i?i=i.next=a:(o=i=a,t(e,r))})},"function"!=typeof r.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(r.prototype[Symbol.asyncIterator]=function(){return this}),r.prototype.next=function(e){return this._invoke("next",e)},r.prototype.throw=function(e){return this._invoke("throw",e)},r.prototype.return=function(e){return this._invoke("return",e)}}(),function(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,t){function n(o,i){try{var u=r[o](i),a=u.value}catch(e){return void t(e)}if(!u.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}),Ce=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")},Ee=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),Te=function(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e},Ge=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Pe=function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)},Me=function(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r},_e=function(){function e(e,r){var t=[],n=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(n=(u=a.next()).done)&&(t.push(u.value),!r||t.length!==r);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(o)throw i}}return t}return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return e(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Ne=function(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)},Be=i("Division"),Ie=function(){function e(r,t){Ce(this,e);var n=Be(this);n.level=r,n.code=t}return Ee(e,[{key:"properties",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){var t,n,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.level.properties(r);case 2:if(t=e.sent,n=this.code,void 0!==(o=t[n])){e.next=8;break}throw i=this.level.identifier,new Error("Could not find properties for "+i+" "+n);case 8:return e.abrupt("return",o);case 9:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"bounds",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.properties(r);case 2:return e.abrupt("return",e.sent.bounds);case 3:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"area",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.properties(r);case 2:return e.abrupt("return",e.sent.area);case 3:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"centroid",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.properties(r);case 2:return e.abrupt("return",e.sent.centroid);case 3:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"poleOfInaccessibility",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.properties(r);case 2:return e.abrupt("return",e.sent.poleOfInaccessibility);case 3:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"geometry",value:function(){var e=Re(regeneratorRuntime.mark(function e(r,t){var n,o,i,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.level.geometries(r,t);case 2:if(n=e.sent,o=this.code,void 0!==(i=n[o])){e.next=8;break}throw u=this.level.identifier,new Error("Could not find "+r+" geometry for "+u+" "+o);case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}},e,this)}));return function(r,t){return e.apply(this,arguments)}}()},{key:"shapeGeometry",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.geometry("shapes",r));case 1:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"outlineGeometry",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.geometry("outlines",r));case 1:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"borderGeometry",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.geometry("borders",r));case 1:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"subdivisionGeometry",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.geometry("subdivisions",r));case 1:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"belongsTo",value:function(e){return e.level===this.level.superlevel&&e.code===this.level.coder.super(this.code)}},{key:"code",get:function(){return Be(this).code}},{key:"level",get:function(){return Be(this).level}},{key:"geography",get:function(){return this.level.geography}},{key:"data",get:function(){var e=this,r=Be(this);return void 0===r.data&&(r.data=this.level.data.find(function(r){return r.code===e.code})),r.data}},{key:"name",get:function(){return this.data.name}},{key:"neighbors",get:function(){var e=this,r=Be(this);return void 0===r.neighbors&&(r.neighbors=this.data.neighbors.map(function(r){return e.constructor.for(r)})),[].concat(Ne(r.neighbors))}},{key:"superdivision",get:function(){var e=this,r=Be(this);if(void 0===r.superdivision){var t=this.level.superlevel;r.superdivision=t?t.divisions.find(function(r){return e.belongsTo(r)}):null}return r.superdivision}},{key:"subdivisions",get:function(){var e=this,r=Be(this);if(void 0===r.subdivisions){var t=this.level.sublevel;r.subdivisions=t?t.divisions.filter(function(r){return r.belongsTo(e)}):[]}return[].concat(Ne(r.subdivisions))}}]),e}(),Ze="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ze=u(function(e,r){function t(e,r){for(var t=0,n=e.length-1;n>=0;n--){var o=e[n];"."===o?e.splice(n,1):".."===o?(e.splice(n,1),t++):t&&(e.splice(n,1),t--)}if(r)for(;t--;t)e.unshift("..");return e}function n(e,r){if(e.filter)return e.filter(r);for(var t=[],n=0;n<e.length;n++)r(e[n],n,e)&&t.push(e[n]);return t}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(e){return o.exec(e).slice(1)};r.resolve=function(){for(var e="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var i=o>=0?arguments[o]:process.cwd();if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,r="/"===i.charAt(0))}return e=t(n(e.split("/"),function(e){return!!e}),!r).join("/"),(r?"/":"")+e||"."},r.normalize=function(e){var o=r.isAbsolute(e),i="/"===u(e,-1);return(e=t(n(e.split("/"),function(e){return!!e}),!o).join("/"))||o||(e="."),e&&i&&(e+="/"),(o?"/":"")+e},r.isAbsolute=function(e){return"/"===e.charAt(0)},r.join=function(){var e=Array.prototype.slice.call(arguments,0);return r.normalize(n(e,function(e,r){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},r.relative=function(e,t){function n(e){for(var r=0;r<e.length&&""===e[r];r++);for(var t=e.length-1;t>=0&&""===e[t];t--);return r>t?[]:e.slice(r,t-r+1)}e=r.resolve(e).substr(1),t=r.resolve(t).substr(1);for(var o=n(e.split("/")),i=n(t.split("/")),u=Math.min(o.length,i.length),a=u,s=0;s<u;s++)if(o[s]!==i[s]){a=s;break}for(var c=[],s=a;s<o.length;s++)c.push("..");return(c=c.concat(i.slice(a))).join("/")},r.sep="/",r.delimiter=":",r.dirname=function(e){var r=i(e),t=r[0],n=r[1];return t||n?(n&&(n=n.substr(0,n.length-1)),t+n):"."},r.basename=function(e,r){var t=i(e)[2];return r&&t.substr(-1*r.length)===r&&(t=t.substr(0,t.length-r.length)),t},r.extname=function(e){return i(e)[3]};var u="b"==="ab".substr(-1)?function(e,r,t){return e.substr(r,t)}:function(e,r,t){return r<0&&(r=e.length+r),e.substr(r,t)}}),Ue=function(){try{if(new Function("return this === window")())return"browser"}catch(e){}try{if(new Function("return this === self")())return"worker"}catch(e){}try{if(new Function("return this === global")())return"node"}catch(e){}}(),Fe=void 0;switch(Ue){case"browser":Fe=window;break;case"worker":Fe=self;break;case"node":Fe=global}var Je={type:Ue,self:Fe},Le={optional:function(e){var r=s(e);return void 0===r?{}:r},required:function(e){var r=s(e);if(void 0===r)throw"node"===Je.type?new Error('Could not resolve module "'+e+'"'):new Error('"'+e+'" isn’t defined in the global scope');return r},browser:function(e){var r=s(e);if(void 0===r){if("node"!==Je.type)throw new Error('"'+e+'" isn’t defined in the global scope');return{}}return r},node:function(e){var r=s(e);if(void 0===r){if("node"===Je.type)throw new Error('Could not resolve module "'+e+'"');return{}}return r}},De=Le.node("path"),He=c(),Ve=void 0;Ve="node"===Je.type?{resolve:De.resolve,normalize:De.normalize,join:De.join,relative:De.relative,dirname:De.dirname,basename:De.basename,extname:De.extname,separator:De.sep,delimiter:De.delimiter}:{resolve:function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return ze.resolve.apply(ze,["/"].concat(r))},normalize:ze.normalize,join:ze.join,relative:ze.relative,dirname:ze.dirname,basename:ze.basename,extname:ze.extname,separator:ze.sep,delimiter:ze.delimiter};var Qe=Ge({self:He,get current(){return c()}},Ve),We={},Ye={},$e=34,Xe=10,Ke=13,er=function(e){function r(e,r){function t(){if(c)return Ye;if(f)return f=!1,We;var r,t,n=a;if(e.charCodeAt(n)===$e){for(;a++<u&&e.charCodeAt(a)!==$e||e.charCodeAt(++a)===$e;);return(r=a)>=u?c=!0:(t=e.charCodeAt(a++))===Xe?f=!0:t===Ke&&(f=!0,e.charCodeAt(a)===Xe&&++a),e.slice(n+1,r-1).replace(/""/g,'"')}for(;a<u;){if((t=e.charCodeAt(r=a++))===Xe)f=!0;else if(t===Ke)f=!0,e.charCodeAt(a)===Xe&&++a;else if(t!==i)continue;return e.slice(n,r)}return c=!0,e.slice(n,u)}var n,o=[],u=e.length,a=0,s=0,c=u<=0,f=!1;for(e.charCodeAt(u-1)===Xe&&--u,e.charCodeAt(u-1)===Ke&&--u;(n=t())!==Ye;){for(var l=[];n!==We&&n!==Ye;)l.push(n),n=t();r&&null==(l=r(l,s++))||o.push(l)}return o}function t(r){return r.map(n).join(e)}function n(e){return null==e?"":o.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}var o=new RegExp('["'+e+"\n\r]"),i=e.charCodeAt(0);return{parse:function(e,t){var n,o,i=r(e,function(e,r){if(n)return n(e,r-1);o=e,n=t?l(e,t):f(e)});return i.columns=o,i},parseRows:r,format:function(r,t){return null==t&&(t=h(r)),[t.map(n).join(e)].concat(r.map(function(r){return t.map(function(e){return n(r[e])}).join(e)})).join("\n")},formatRows:function(e){return e.map(t).join("\n")}}},rr=er(",").parse,tr=er("\t").parse,nr=function(e,r){if(r=r.split(":")[0],!(e=+e))return!1;switch(r){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e},or=Object.prototype.hasOwnProperty,ir={stringify:function(e,r){var t=[];"string"!=typeof(r=r||"")&&(r="?");for(var n in e)or.call(e,n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.length?r+t.join("&"):""},parse:function(e){for(var r,t=/([^=?&]+)=?([^&]*)/g,n={};r=t.exec(e);n[p(r[1])]=p(r[2]));return n}},ur=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,ar=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,sr=[["#","hash"],["?","query"],["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],cr={hash:1,query:1};g.prototype={set:function(e,r,t){var n=this;switch(e){case"query":"string"==typeof r&&r.length&&(r=(t||ir.parse)(r)),n[e]=r;break;case"port":n[e]=r,nr(r,n.protocol)?r&&(n.host=n.hostname+":"+r):(n.host=n.hostname,n[e]="");break;case"hostname":n[e]=r,n.port&&(r+=":"+n.port),n.host=r;break;case"host":n[e]=r,/:\d+$/.test(r)?(r=r.split(":"),n.port=r.pop(),n.hostname=r.join(":")):(n.hostname=r,n.port="");break;case"protocol":n.protocol=r.toLowerCase(),n.slashes=!t;break;case"pathname":n.pathname=r.length&&"/"!==r.charAt(0)?"/"+r:r;break;default:n[e]=r}for(var o=0;o<sr.length;o++){var i=sr[o];i[4]&&(n[i[1]]=n[i[1]].toLowerCase())}return n.origin=n.protocol&&n.host&&"file:"!==n.protocol?n.protocol+"//"+n.host:"null",n.href=n.toString(),n},toString:function(e){e&&"function"==typeof e||(e=ir.stringify);var r,t=this,n=t.protocol;n&&":"!==n.charAt(n.length-1)&&(n+=":");var o=n+(t.slashes?"//":"");return t.username&&(o+=t.username,t.password&&(o+=":"+t.password),o+="@"),o+=t.host+t.pathname,(r="object"===Oe(t.query)?e(t.query):t.query)&&(o+="?"!==r.charAt(0)?"?"+r:r),t.hash&&(o+=t.hash),o}},g.extractProtocol=d,g.location=v,g.qs=ir;var fr=g,lr=Le.node("fs").readFile,hr=Le.node("request"),pr=(i("Request"),{text:function(){var e=w.apply(void 0,arguments),r=_e(e,2),t=r[0],n=r[1];return n.type="text",b(t,n)},json:function(){var e=w.apply(void 0,arguments),r=_e(e,2),t=r[0],n=r[1];return n.type="json",b(t,n)},buffer:function(){var e=w.apply(void 0,arguments),r=_e(e,2),t=r[0],n=r[1];return n.type="arraybuffer",n.encoding=null,b(t,n)},csv:function(){var e=w.apply(void 0,arguments),r=_e(e,2),t=r[0],n=r[1];return this.text(t,n).then(function(e){return rr(e,n.row)})},tsv:function(){var e=w.apply(void 0,arguments),r=_e(e,2),t=r[0],n=r[1];return this.text(t,n).then(function(e){return tr(e,n.row)})}}),vr={packBufferGeometry:function(e){var r=k(e),t=_e(r,3);return[t[0],A(t[1],t[2])]},packBufferGeometries:function(e){var r=j(e),t=_e(r,3);return[t[0],A(t[1],t[2])]},unpackBufferGeometry:function(e,r){return q(e,r)},unpackBufferGeometries:function(e,r){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;++n)t.push(q(e,r));return t}for(var o={},i=Object.keys(e),u=0;u<i.length;++u){var a=i[u];o[a]=q(e[a],r)}return o}},dr=i("DivisionLevel"),yr=function(){function e(r,t){Ce(this,e);var n=dr(this);n.identifier=r,n.coder=t,n.divisions={},n.properties={},n.geometries={}}return Ee(e,[{key:"init",value:function(e){dr(this).geography=e}},{key:"division",value:function(e){var r=dr(this),t=r.divisions[e];return void 0===t&&(t=new Ie(this,e),r.divisions[e]=t),t}},{key:"properties",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){var t,n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=dr(this),n=r?r.hash:null,void 0===t.properties[n]&&(o=Qe.join(Qe.dirname(this.geography.path),n||"",this.geography.identifier,this.identifier,"properties.json"),t.properties[n]=pr.json(o,{local:!0})),e.abrupt("return",t.properties[n]);case 4:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"geometries",value:function(){var e=Re(regeneratorRuntime.mark(function e(r,t){var n,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=dr(this),o=t?t.hash:null,void 0===(i=n.geometries[o])&&(i={},n.geometries[o]=i),void 0===i[r]&&(i[r]=this.requestGeometries(r,t)),e.abrupt("return",i[r]);case 6:case"end":return e.stop()}},e,this)}));return function(r,t){return e.apply(this,arguments)}}()},{key:"requestGeometries",value:function(){var e=Re(regeneratorRuntime.mark(function e(r,t){var n,o,i,u,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Qe.join(Qe.dirname(this.geography.path),t.hash,this.geography.identifier,this.identifier,r),o=void 0,i=void 0,e.prev=3,e.next=6,Promise.all([pr.json(n+".json"),pr.buffer(n+".buffer")]);case 6:u=e.sent,a=_e(u,2),o=a[0],i=a[1],e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(3),e.t0;case 15:return e.abrupt("return",vr.unpackBufferGeometries(o,i));case 16:case"end":return e.stop()}},e,this,[[3,12]])}));return function(r,t){return e.apply(this,arguments)}}()},{key:"identifier",get:function(){return dr(this).identifier}},{key:"coder",get:function(){return dr(this).coder}},{key:"geography",get:function(){return dr(this).geography}},{key:"data",get:function(){var e=dr(this);return void 0===e.data&&(e.data=this.geography.data[this.identifier]),e.data}},{key:"divisions",get:function(){var e=this,r=dr(this);return r.divisions=Ge({},r.divisions,this.data.reduce(function(t,n){var o=n.code;return void 0===r.divisions[o]?Ge({},t,Te({},o,new Ie(e,o))):t},{})),Object.values(r.divisions)}},{key:"codes",get:function(){var e=dr(this);return void 0===e.codes&&(e.codes=this.data.map(function(e){return e.code})),[].concat(Ne(e.codes))}},{key:"superlevel",get:function(){var e=dr(this);if(void 0===e.superlevel){var r=this.geography.levels,t=r.indexOf(this);if(-1===t)throw new Error("Could not find levels for geography");e.superlevel=r[t-1]||null}return e.superlevel}},{key:"sublevel",get:function(){var e=dr(this);if(void 0===e.sublevel){var r=this.geography.levels,t=r.indexOf(this);if(-1===t)throw new Error("Could not find levels for geography");e.sublevel=r[t+1]||null}return e.sublevel}}]),e}(),gr=i("Geography"),mr=function(){function e(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Ce(this,e);var n=gr(this);n.identifier=r,n.levels=t,n.properties={},n.geometries={}}return Ee(e,[{key:"init",value:function(){var e=Re(regeneratorRuntime.mark(function e(r,t){var n,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=gr(this),n.path=r,!t){e.next=8;break}return e.next=5,Promise.resolve(t);case 5:n.data=e.sent,e.next=11;break;case 8:return e.next=10,pr.json(r,{local:!0});case 10:n.data=e.sent;case 11:return e.next=13,Promise.all(this.levels.map(function(e){return e.init(o)}));case 13:case"end":return e.stop()}},e,this)}));return function(r,t){return e.apply(this,arguments)}}()},{key:"division",value:function(e,r){var t=this.levels.find(function(r){return r.identifier===e});if(void 0===t)throw new Error("Could not find "+e+" level in geography");return t.division(r)}},{key:"divisions",value:function(e){var r=this.levels.find(function(r){return r.identifier===e});if(void 0===r)throw new Error("Could not find "+e+" level in geography");return r.divisions}},{key:"codes",value:function(e){var r=this.levels.find(function(r){return r.identifier===e});if(void 0===r)throw new Error("Could not find "+e+" level in geography");return r.codes}},{key:"properties",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){var t,n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=gr(this),n=r?r.hash:null,void 0===t.properties[n]&&(o=Qe.join(Qe.dirname(this.path),n||"",this.identifier,"properties.json"),t.properties[n]=pr.json(o,{local:!0})),e.abrupt("return",t.properties[n]);case 4:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"bounds",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.properties(r);case 2:return e.abrupt("return",e.sent.bounds);case 3:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"area",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.properties(r);case 2:return e.abrupt("return",e.sent.area);case 3:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"centroid",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.properties(r);case 2:return e.abrupt("return",e.sent.centroid);case 3:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"poleOfInaccessibility",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.properties(r);case 2:return e.abrupt("return",e.sent.poleOfInaccessibility);case 3:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"geometry",value:function(){var e=Re(regeneratorRuntime.mark(function e(r,t){var n,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=gr(this),o=t?t.hash:null,void 0===(i=n.geometries[o])&&(i={},n.geometries[o]=i),void 0===i[r]&&(i[r]=this.requestGeometry(r,t)),e.abrupt("return",i[r]);case 6:case"end":return e.stop()}},e,this)}));return function(r,t){return e.apply(this,arguments)}}()},{key:"requestGeometry",value:function(){var e=Re(regeneratorRuntime.mark(function e(r,t){var n,o,i,u,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Qe.join(Qe.dirname(this.path),t.hash,this.identifier,r),o=void 0,i=void 0,e.prev=3,e.next=6,Promise.all([pr.json(n+".json"),pr.buffer(n+".buffer")]);case 6:u=e.sent,a=_e(u,2),o=a[0],i=a[1],e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(3),e.t0;case 15:return e.abrupt("return",vr.unpackBufferGeometry(o,i));case 16:case"end":return e.stop()}},e,this,[[3,12]])}));return function(r,t){return e.apply(this,arguments)}}()},{key:"shapeGeometry",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.geometry("shape",r));case 1:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"outlineGeometry",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.geometry("outline",r));case 1:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"subdivisionGeometry",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.geometry("subdivision",r));case 1:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"identifier",get:function(){return gr(this).identifier}},{key:"levels",get:function(){var e=gr(this);return[].concat(Ne(e.levels))}},{key:"path",get:function(){return gr(this).path}},{key:"data",get:function(){var e=gr(this);if(!e.data)throw new Error("Data is missing for "+this.identifier);return e.data}}]),e}(),xr=S;S.deviation=function(e,r,t,n){var o=r&&r.length,i=o?r[0]*t:e.length,u=Math.abs(ee(e,0,i,t));if(o)for(var a=0,s=r.length;a<s;a++){var c=r[a]*t,f=a<s-1?r[a+1]*t:e.length;u-=Math.abs(ee(e,c,f,t))}var l=0;for(a=0;a<n.length;a+=3){var h=n[a]*t,p=n[a+1]*t,v=n[a+2]*t;l+=Math.abs((e[h]-e[v])*(e[p+1]-e[h+1])-(e[h]-e[p])*(e[v+1]-e[h+1]))}return 0===u&&0===l?0:Math.abs((l-u)/u)},S.flatten=function(e){for(var r=e[0][0].length,t={vertices:[],holes:[],dimensions:r},n=0,o=0;o<e.length;o++){for(var i=0;i<e[o].length;i++)for(var u=0;u<r;u++)t.vertices.push(e[o][i][u]);o>0&&(n+=e[o-1].length,t.holes.push(n))}return t};var br=re;re.prototype={push:function(e){this.data.push(e),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var e=this.data[0];return--this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),e}},peek:function(){return this.data[0]},_up:function(e){for(var r=this.data,t=this.compare,n=r[e];e>0;){var o=e-1>>1,i=r[o];if(t(n,i)>=0)break;r[e]=i,e=o}r[e]=n},_down:function(e){for(var r=this.data,t=this.compare,n=this.length,o=n>>1,i=r[e];e<o;){var u=1+(e<<1),a=u+1,s=r[u];if(a<n&&t(r[a],s)<0&&(u=a,s=r[a]),t(s,i)>=0)break;r[e]=s,e=u}r[e]=i}};var wr=ne,kr=ne;wr.default=kr;var jr={min:function(e,r){var t=void 0,n=Number.POSITIVE_INFINITY;if("function"!=typeof r){for(var o=0;o<e.length;++o){var i=e[o];i<n&&(t=i,n=i)}return t}for(var u=0;u<e.length;++u){var a=e[u],s=r(a,u);s<n&&(t=a,n=s)}return t},max:function(e,r){var t=void 0,n=Number.NEGATIVE_INFINITY;if("function"!=typeof r){for(var o=0;o<e.length;++o){var i=e[o];i>n&&(t=i,n=i)}return t}for(var u=0;u<e.length;++u){var a=e[u],s=r(a,u);s>n&&(t=a,n=s)}return t}};!function(e,r){function t(){this.constructor=e}t.prototype=r.prototype,e.prototype=new t}(ce,Error),ce.buildMessage=function(e,r){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}function n(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+t(e)})}function o(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+t(e)})}function i(e){return u[e.type](e)}var u={literal:function(e){return'"'+n(e.text)+'"'},class:function(e){var r,t="";for(r=0;r<e.parts.length;r++)t+=e.parts[r]instanceof Array?o(e.parts[r][0])+"-"+o(e.parts[r][1]):o(e.parts[r]);return"["+(e.inverted?"^":"")+t+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};return"Expected "+function(e){var r,t,n=new Array(e.length);for(r=0;r<e.length;r++)n[r]=i(e[r]);if(n.sort(),n.length>0){for(r=1,t=1;r<n.length;r++)n[r-1]!==n[r]&&(n[t]=n[r],t++);n.length=t}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(e)+" but "+function(e){return e?'"'+n(e)+'"':"end of input"}(r)+" found."};var qr={SyntaxError:ce,parse:function(e,r){function t(e,r){return{type:"literal",text:e,ignoreCase:r}}function n(e,r,t){return{type:"class",parts:e,inverted:r,ignoreCase:t}}function o(r){var t,n=Ye[r];if(n)return n;for(t=r-1;!Ye[t];)t--;for(n={line:(n=Ye[t]).line,column:n.column};t<r;)10===e.charCodeAt(t)?(n.line++,n.column=1):n.column++,t++;return Ye[r]=n,n}function i(e,r){var t=o(e),n=o(r);return{start:{offset:e,line:t.line,column:t.column},end:{offset:r,line:n.line,column:n.column}}}function u(e){We<$e||(We>$e&&($e=We,Xe=[]),Xe.push(e))}function a(){var e,r,t,n,o;for(e=We,r=[],t=J();t!==V;)r.push(t),t=J();if(r!==V)if((t=s())===V&&(t=null),t!==V){for(n=[],o=J();o!==V;)n.push(o),o=J();n!==V?e=r=Y(t):(We=e,e=V)}else We=e,e=V;else We=e,e=V;return e}function s(){var e,r,t,n,o,i;if(e=We,(r=c())!==V){for(t=[],n=We,o=[],i=J();i!==V;)o.push(i),i=J();for(o!==V&&(i=c())!==V?n=o=[o,i]:(We=n,n=V);n!==V;){for(t.push(n),n=We,o=[],i=J();i!==V;)o.push(i),i=J();o!==V&&(i=c())!==V?n=o=[o,i]:(We=n,n=V)}t!==V?e=r=$(r,t):(We=e,e=V)}else We=e,e=V;return e}function c(){var e,r,t,n,o,i;if(e=We,(r=l())!==V){for(t=[],n=We,o=[],i=J();i!==V;)o.push(i),i=J();for(o!==V&&(i=f())!==V?n=o=[o,i]:(We=n,n=V);n!==V;){for(t.push(n),n=We,o=[],i=J();i!==V;)o.push(i),i=J();o!==V&&(i=f())!==V?n=o=[o,i]:(We=n,n=V)}t!==V?e=r=$(r,t):(We=e,e=V)}else We=e,e=V;return e}function f(){var e;return(e=h())===V&&(e=p())===V&&(e=d())===V&&(e=g())===V&&(e=m())===V&&(e=w())===V&&(e=q())===V&&(e=O())===V&&(e=C()),e}function l(){var r,t,n,o,i,a,s;if(r=We,X.test(e.charAt(We))?(t=e.charAt(We),We++):(t=V,0===Ke&&u(K)),t!==V){for(n=[],o=J();o!==V;)n.push(o),o=J();n!==V&&(o=G())!==V?(i=We,(a=N())===V&&(a=null),a!==V&&(s=v())!==V?i=a=[a,s]:(We=i,i=V),i===V&&(i=null),i!==V?r=t=ee(t,o,i):(We=r,r=V)):(We=r,r=V)}else We=r,r=V;return r}function h(){var r;return re.test(e.charAt(We))?(r=e.charAt(We),We++):(r=V,0===Ke&&u(te)),r!==V&&(r=ne()),r}function p(){var r,t,n,o;if(r=We,oe.test(e.charAt(We))?(t=e.charAt(We),We++):(t=V,0===Ke&&u(ie)),t!==V){for(n=[],o=J();o!==V;)n.push(o),o=J();n!==V&&(o=v())!==V?r=t=ue(t,o):(We=r,r=V)}else We=r,r=V;return r}function v(){var e,r,t,n,o,i;if(e=We,(r=G())!==V){for(t=[],n=We,(o=N())===V&&(o=null),o!==V&&(i=G())!==V?n=o=[o,i]:(We=n,n=V);n!==V;)t.push(n),n=We,(o=N())===V&&(o=null),o!==V&&(i=G())!==V?n=o=[o,i]:(We=n,n=V);t!==V?e=r=$(r,t):(We=e,e=V)}else We=e,e=V;return e}function d(){var r,t,n,o;if(r=We,ae.test(e.charAt(We))?(t=e.charAt(We),We++):(t=V,0===Ke&&u(se)),t!==V){for(n=[],o=J();o!==V;)n.push(o),o=J();n!==V&&(o=y())!==V?r=t=fe(t,o):(We=r,r=V)}else We=r,r=V;return r}function y(){var e,r,t,n,o,i;if(e=We,(r=M())!==V){for(t=[],n=We,(o=N())===V&&(o=null),o!==V&&(i=M())!==V?n=o=[o,i]:(We=n,n=V);n!==V;)t.push(n),n=We,(o=N())===V&&(o=null),o!==V&&(i=M())!==V?n=o=[o,i]:(We=n,n=V);t!==V?e=r=$(r,t):(We=e,e=V)}else We=e,e=V;return e}function g(){var r,t,n,o;if(r=We,le.test(e.charAt(We))?(t=e.charAt(We),We++):(t=V,0===Ke&&u(he)),t!==V){for(n=[],o=J();o!==V;)n.push(o),o=J();n!==V&&(o=y())!==V?r=t=pe(t,o):(We=r,r=V)}else We=r,r=V;return r}function m(){var r,t,n,o;if(r=We,ve.test(e.charAt(We))?(t=e.charAt(We),We++):(t=V,0===Ke&&u(de)),t!==V){for(n=[],o=J();o!==V;)n.push(o),o=J();n!==V&&(o=x())!==V?r=t=ue(t,o):(We=r,r=V)}else We=r,r=V;return r}function x(){var e,r,t,n,o,i;if(e=We,(r=b())!==V){for(t=[],n=We,(o=N())===V&&(o=null),o!==V&&(i=b())!==V?n=o=[o,i]:(We=n,n=V);n!==V;)t.push(n),n=We,(o=N())===V&&(o=null),o!==V&&(i=b())!==V?n=o=[o,i]:(We=n,n=V);t!==V?e=r=$(r,t):(We=e,e=V)}else We=e,e=V;return e}function b(){var e,r,t,n,o,i;return e=We,(r=G())!==V?((t=N())===V&&(t=null),t!==V&&(n=G())!==V?((o=N())===V&&(o=null),o!==V&&(i=G())!==V?e=r=ye(r,n,i):(We=e,e=V)):(We=e,e=V)):(We=e,e=V),e}function w(){var r,t,n,o;if(r=We,ge.test(e.charAt(We))?(t=e.charAt(We),We++):(t=V,0===Ke&&u(me)),t!==V){for(n=[],o=J();o!==V;)n.push(o),o=J();n!==V&&(o=k())!==V?r=t=ue(t,o):(We=r,r=V)}else We=r,r=V;return r}function k(){var e,r,t,n,o,i;if(e=We,(r=j())!==V){for(t=[],n=We,(o=N())===V&&(o=null),o!==V&&(i=j())!==V?n=o=[o,i]:(We=n,n=V);n!==V;)t.push(n),n=We,(o=N())===V&&(o=null),o!==V&&(i=j())!==V?n=o=[o,i]:(We=n,n=V);t!==V?e=r=$(r,t):(We=e,e=V)}else We=e,e=V;return e}function j(){var e,r,t,n;return e=We,(r=G())!==V?((t=N())===V&&(t=null),t!==V&&(n=G())!==V?e=r=xe(r,n):(We=e,e=V)):(We=e,e=V),e}function q(){var r,t,n,o;if(r=We,be.test(e.charAt(We))?(t=e.charAt(We),We++):(t=V,0===Ke&&u(we)),t!==V){for(n=[],o=J();o!==V;)n.push(o),o=J();n!==V&&(o=A())!==V?r=t=ue(t,o):(We=r,r=V)}else We=r,r=V;return r}function A(){var e,r,t,n,o,i;if(e=We,(r=S())!==V){for(t=[],n=We,(o=N())===V&&(o=null),o!==V&&(i=S())!==V?n=o=[o,i]:(We=n,n=V);n!==V;)t.push(n),n=We,(o=N())===V&&(o=null),o!==V&&(i=S())!==V?n=o=[o,i]:(We=n,n=V);t!==V?e=r=$(r,t):(We=e,e=V)}else We=e,e=V;return e}function S(){var e,r,t,n;return e=We,(r=G())!==V?((t=N())===V&&(t=null),t!==V&&(n=G())!==V?e=r=ke(r,n):(We=e,e=V)):(We=e,e=V),e}function O(){var r,t,n,o;if(r=We,je.test(e.charAt(We))?(t=e.charAt(We),We++):(t=V,0===Ke&&u(qe)),t!==V){for(n=[],o=J();o!==V;)n.push(o),o=J();n!==V&&(o=R())!==V?r=t=ue(t,o):(We=r,r=V)}else We=r,r=V;return r}function R(){var e,r,t,n,o,i;if(e=We,(r=G())!==V){for(t=[],n=We,(o=N())===V&&(o=null),o!==V&&(i=G())!==V?n=o=[o,i]:(We=n,n=V);n!==V;)t.push(n),n=We,(o=N())===V&&(o=null),o!==V&&(i=G())!==V?n=o=[o,i]:(We=n,n=V);t!==V?e=r=$(r,t):(We=e,e=V)}else We=e,e=V;return e}function C(){var r,t,n,o;if(r=We,Ae.test(e.charAt(We))?(t=e.charAt(We),We++):(t=V,0===Ke&&u(Se)),t!==V){for(n=[],o=J();o!==V;)n.push(o),o=J();n!==V&&(o=E())!==V?r=t=ue(t,o):(We=r,r=V)}else We=r,r=V;return r}function E(){var e,r,t,n,o,i;if(e=We,(r=T())!==V){for(t=[],n=We,(o=N())===V&&(o=null),o!==V&&(i=T())!==V?n=o=[o,i]:(We=n,n=V);n!==V;)t.push(n),n=We,(o=N())===V&&(o=null),o!==V&&(i=T())!==V?n=o=[o,i]:(We=n,n=V);t!==V?e=r=$(r,t):(We=e,e=V)}else We=e,e=V;return e}function T(){var e,r,t,n,o,i,u,a,s,c,f;return e=We,(r=P())!==V?((t=N())===V&&(t=null),t!==V&&(n=P())!==V?((o=N())===V&&(o=null),o!==V&&(i=M())!==V&&N()!==V&&(u=_())!==V?((a=N())===V&&(a=null),a!==V&&(s=_())!==V?((c=N())===V&&(c=null),c!==V&&(f=G())!==V?e=r=Oe(r,n,i,u,s,f):(We=e,e=V)):(We=e,e=V)):(We=e,e=V)):(We=e,e=V)):(We=e,e=V),e}function G(){var e,r,t,n;return e=We,(r=M())!==V?((t=N())===V&&(t=null),t!==V&&(n=M())!==V?e=r=Re(r,n):(We=e,e=V)):(We=e,e=V),e}function P(){var e;return(e=I())===V&&(e=F()),e!==V&&(e=Ce(e)),e}function M(){var e,r,t;return e=We,(r=U())===V&&(r=null),r!==V&&(t=I())!==V?e=r=[r,t]:(We=e,e=V),e===V&&(e=We,(r=U())===V&&(r=null),r!==V&&(t=F())!==V?e=r=[r,t]:(We=e,e=V)),e!==V&&(e=Ee(e)),e}function _(){var r;return Te.test(e.charAt(We))?(r=e.charAt(We),We++):(r=V,0===Ke&&u(Ge)),r!==V&&(r=Pe(r)),r}function N(){var e,r,t,n,o;if(e=We,r=[],(t=J())!==V)for(;t!==V;)r.push(t),t=J();else r=V;if(r!==V)if((t=B())===V&&(t=null),t!==V){for(n=[],o=J();o!==V;)n.push(o),o=J();n!==V?e=r=[r,t,n]:(We=e,e=V)}else We=e,e=V;else We=e,e=V;if(e===V){if(e=We,r=We,(t=B())!==V){for(n=[],o=J();o!==V;)n.push(o),o=J();n!==V?r=t=[t,n]:(We=r,r=V)}else We=r,r=V;r!==V&&(r=Me()),e=r}return e}function B(){var r;return 44===e.charCodeAt(We)?(r=_e,We++):(r=V,0===Ke&&u(Ne)),r}function I(){var e,r,t;return e=We,(r=Z())!==V?((t=z())===V&&(t=null),t!==V?e=r=[r,t]:(We=e,e=V)):(We=e,e=V),e===V&&(e=We,(r=F())!==V&&(t=z())!==V?e=r=[r,t]:(We=e,e=V)),e!==V&&(e=Be(e)),e}function Z(){var r,t,n,o;return r=We,(t=F())===V&&(t=null),t!==V?(46===e.charCodeAt(We)?(n=Ie,We++):(n=V,0===Ke&&u(Ze)),n!==V&&(o=F())!==V?r=t=[t,n,o]:(We=r,r=V)):(We=r,r=V),r===V&&(r=We,(t=F())!==V?(46===e.charCodeAt(We)?(n=Ie,We++):(n=V,0===Ke&&u(Ze)),n!==V?r=t=[t,n]:(We=r,r=V)):(We=r,r=V)),r!==V&&(r=Be(r)),r}function z(){var r,t,n,o;return r=We,ze.test(e.charAt(We))?(t=e.charAt(We),We++):(t=V,0===Ke&&u(Ue)),t!==V?((n=U())===V&&(n=null),n!==V&&(o=F())!==V?r=t=[t,n,o]:(We=r,r=V)):(We=r,r=V),r!==V&&(r=Be(r)),r}function U(){var r;return Fe.test(e.charAt(We))?(r=e.charAt(We),We++):(r=V,0===Ke&&u(Je)),r}function F(){var r,t;if(r=[],Le.test(e.charAt(We))?(t=e.charAt(We),We++):(t=V,0===Ke&&u(De)),t!==V)for(;t!==V;)r.push(t),Le.test(e.charAt(We))?(t=e.charAt(We),We++):(t=V,0===Ke&&u(De));else r=V;return r!==V&&(r=He(r)),r}function J(){var r;return Ve.test(e.charAt(We))?(r=e.charAt(We),We++):(r=V,0===Ke&&u(Qe)),r!==V&&(r=Me()),r}function L(e,r){if(!r)return[e];for(var t=[e],n=0,o=r.length;n<o;n++)t[n+1]=r[n][1];return t}function D(e,r){r||(r=[{}]);for(var t=r.length;t--;){var n={code:e,command:er[e]};e==e.toLowerCase()&&(n.relative=!0);for(var o in r[t])n[o]=r[t][o];r[t]=n}return r}r=void 0!==r?r:{};var H,V={},Q={svg_path:a},W=a,Y=function(e){if(!e)return[];for(var r=[],t=0;t<e.length;t++)r=r.concat.apply(r,e[t]);var n=r[0];return n&&"m"==n.code&&(delete n.relative,n.code="M"),r},$=function(e,r){return L(e,r)},X=/^[Mm]/,K=n(["M","m"],!1,!1),ee=function(e,r,t){var n=D(e,[r]);return t&&(n=n.concat(D("M"==e?"L":"l",t[1]))),n},re=/^[Zz]/,te=n(["Z","z"],!1,!1),ne=function(){return D("Z")},oe=/^[Ll]/,ie=n(["L","l"],!1,!1),ue=function(e,r){return D(e,r)},ae=/^[Hh]/,se=n(["H","h"],!1,!1),fe=function(e,r){return D(e,r.map(function(e){return{x:e}}))},le=/^[Vv]/,he=n(["V","v"],!1,!1),pe=function(e,r){return D(e,r.map(function(e){return{y:e}}))},ve=/^[Cc]/,de=n(["C","c"],!1,!1),ye=function(e,r,t){return{x1:e.x,y1:e.y,x2:r.x,y2:r.y,x:t.x,y:t.y}},ge=/^[Ss]/,me=n(["S","s"],!1,!1),xe=function(e,r){return{x2:e.x,y2:e.y,x:r.x,y:r.y}},be=/^[Qq]/,we=n(["Q","q"],!1,!1),ke=function(e,r){return{x1:e.x,y1:e.y,x:r.x,y:r.y}},je=/^[Tt]/,qe=n(["T","t"],!1,!1),Ae=/^[Aa]/,Se=n(["A","a"],!1,!1),Oe=function(e,r,t,n,o,i){return{rx:e,ry:r,xAxisRotation:t,largeArc:n,sweep:o,x:i.x,y:i.y}},Re=function(e,r){return{x:e,y:r}},Ce=function(e){return 1*e},Ee=function(e){return 1*e.join("")},Te=/^[01]/,Ge=n(["0","1"],!1,!1),Pe=function(e){return"1"==e},Me=function(){return""},_e=",",Ne=t(",",!1),Be=function(e){return e.join("")},Ie=".",Ze=t(".",!1),ze=/^[eE]/,Ue=n(["e","E"],!1,!1),Fe=/^[+\-]/,Je=n(["+","-"],!1,!1),Le=/^[0-9]/,De=n([["0","9"]],!1,!1),He=function(e){return e.join("")},Ve=/^[ \t\n\r]/,Qe=n([" ","\t","\n","\r"],!1,!1),We=0,Ye=[{line:1,column:1}],$e=0,Xe=[],Ke=0;if("startRule"in r){if(!(r.startRule in Q))throw new Error("Can't start parsing from rule \""+r.startRule+'".');W=Q[r.startRule]}var er={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var rr in er)er[rr.toUpperCase()]=er[rr];if((H=W())!==V&&We===e.length)return H;throw H!==V&&We<e.length&&u({type:"end"}),function(e,r,t){return new ce(ce.buildMessage(e,r),e,r,t)}(Xe,$e<e.length?e.charAt($e):null,$e<e.length?i($e,$e+1):i($e,$e))}}.parse;qr.parseSVG=qr,qr.makeAbsolute=function(e){var r,t={x:0,y:0},n={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return e.forEach(function(e){"moveto"===e.command&&(r=e),e.x0=t.x,e.y0=t.y;for(var o in n)o in e&&(e[o]+=e.relative?e[n[o]]:0);"x"in e||(e.x=t.x),"y"in e||(e.y=t.y),e.relative=!1,e.code=e.code.toUpperCase(),"closepath"==e.command&&(e.x=r.x,e.y=r.y),t=e}),e};var Ar=qr;Object.setPrototypeOf(fe,Error),(fe.prototype=Object.create(Error.prototype)).name="ImplementationError",fe.prototype.message="",fe.prototype.constructor=fe;var Sr,Or,Rr,Cr,Er={winding:function(e){if(!(e.length<3)){var r=e[0],t=le(e[e.length-1].v2,r.v1);return(t=e.reduce(function(e,r){return e+le(r.v1,r.v2)},t))<0?"ccw":t>0?"cw":void 0}},contains:function(e,r){if(e.length<3)return!1;var t=e[0],n=he(e[e.length-1].v2,t.v1,r);return(n=e.reduce(function(e,t){return e+he(t.v1,t.v2,r)},n))%2==1},parse:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0,o=0,i=0,u=0,a=0,s=0,c=void 0,f=Ar(e).reduce(function(e,f){switch(f.code){case"M":case"m":!0===f.relative?(a+=f.x,s+=f.y):(a=f.x,s=f.y),c&&0===c.curves.length&&e.pop(),c=new r.Path,e.push(c),t?c.moveTo(a,-s):c.moveTo(a,s);break;case"L":case"l":!0===f.relative?(a+=f.x,s+=f.y):(a=f.x,s=f.y),t?c.lineTo(a,-s):c.lineTo(a,s);break;case"V":case"v":!0===f.relative?s+=f.y:s=f.y,t?c.lineTo(a,-s):c.lineTo(a,s);break;case"H":case"h":!0===f.relative?a+=f.x:a=f.x,t?c.lineTo(a,-s):c.lineTo(a,s);break;case"C":case"c":!0===f.relative?(n=a+f.x1,o=s+f.y1,i=a+f.x2,u=s+f.y2,a+=f.x,s+=f.y):(n=f.x1,o=f.y1,i=f.x2,u=f.y2,a=f.x,s=f.y),t?c.bezierCurveTo(n,-o,i,-u,a,-s):c.bezierCurveTo(n,o,i,u,a,s);break;case"S":case"s":n=a+(a-i),o=s+(s-u),!0===f.relative?(i=a+f.x2,u=s+f.y2,a+=f.x,s+=f.y):(i=f.x2,u=f.y2,a=f.x,s=f.y),t?c.bezierCurveTo(n,-o,i,-u,a,-s):c.bezierCurveTo(n,o,i,u,a,s);break;case"Q":case"q":!0===f.relative?(n=a+f.x1,o=s+f.y1,a+=f.x,s+=f.y):(n=f.x1,o=f.y1,a=f.x,s=f.y),t?c.quadraticCurveTo(n,-o,a,-s):c.quadraticCurveTo(n,o,a,s);break;case"T":case"t":n=a+(a-n),o=s+(s-o),!0===f.relative?(a+=f.x,s+=f.y):(a=f.x,s=f.y),t?c.quadraticCurveTo(n,-o,a,-s):c.quadraticCurveTo(n,o,a,s);break;case"A":case"a":throw new fe;case"Z":c.closePath();break;default:throw new Error('Unknown code "'+f.code+'"')}return e},[]);return 0===f.length?null:1===f.length?f[0]:f.reduce(function(e,r){return e.add(r),e},new r.Shape)}},Tr=Object.assign({},t,n),Gr=Le.optional("topojson"),Pr=i("GeographyBuilder"),Mr=function(){function e(r){Ce(this,e),Pr(this).levels=[].concat(Ne(r))}return Ee(e,[{key:"init",value:function(){var e=Re(regeneratorRuntime.mark(function e(r){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Pr(this),"string"!=typeof r){e.next=7;break}return e.next=4,pr.json(r,{local:!0});case 4:t.data=e.sent,e.next=10;break;case 7:return e.next=9,Promise.resolve(r);case 9:t.data=e.sent;case 10:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}()},{key:"property",value:function(e,r){var t=r.level,n=r.code,o=r.projection,i=this.data.objects.geography.geometries;t&&(i=i.filter(function(e){return ve(t,n,e)}));var u=Gr.merge(this.data,i);return o?o.path[e](u):Tr["geo"+e.charAt().toUpperCase()+e.slice(1)](u)}},{key:"bounds",value:function(e){return this.property("bounds",e)}},{key:"area",value:function(e){return this.property("area",e)}},{key:"centroid",value:function(e){return this.property("centroid",e)}},{key:"poleOfInaccessibility",value:function(e){var t=e.level,n=e.code,o=e.projection,i=e.precision,u=void 0===i?.01:i,a=this.data.objects.geography.geometries;if(t&&(a=a.filter(function(e){return ve(t,n,e)})),a=Gr.merge(this.data,a),o){var s=jr.max(a.coordinates,function(e){return o.path.area({type:"Polygon",coordinates:e})});if(!s)return console.warn("Unable to derive pole of inaccessibility:",t,n),null;var c=o.path({type:"Polygon",coordinates:s});if(!c)return console.warn("Unable to derive pole of inaccessibility:",t,n),null;var f=Er.parse(c,!0);if(!f)return console.warn("Unable to derive pole of inaccessibility:",t,n),null;var l=void 0,h=(l=f instanceof r.Shape?f.curves:[f]).map(function(e){return e.curves.map(function(e){return[e.v1.x,e.v1.y]})});return wr(h,Math.sqrt(o.path.area({type:"Polygon",coordinates:s}))*u)}var p=jr.max(a.coordinates,function(e){return Tr.geoArea({type:"Polygon",coordinates:e})});return p?wr(p,Math.sqrt(Tr.geoArea({type:"Polygon",coordinates:p}))*u):(console.warn("Unable to derive pole of inaccessibility:",t,n),null)}},{key:"shapes",value:function(e){var r=e.geometries,t=e.projection,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return ye(Gr.merge(this.data,r),t,n)}},{key:"shapeGeometry",value:function(e){var r=e.geometries,t=e.projection,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return ge(ye(Gr.merge(this.data,r),t,n))}},{key:"outlineGeometry",value:function(e){var r=e.geometries,t=e.projection,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return xe(ye(Gr.merge(this.data,r),t,n))}},{key:"borderGeometry",value:function(e){var t=e.object,n=e.filter,o=e.projection,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],u=Gr.mesh(this.data,t,n),a=o.path(u);if(!a)return i.push(0),me([]);var s=Er.parse(a,!0),c=void 0;return c=s instanceof r.Shape?s.curves.reduce(function(e,r){return e.concat(r.curves)},[]):s.curves,me(c)}},{key:"geographyShapes",value:function(e){var r=e.projection,t=this.data.objects.geography.geometries,n=[],o=this.shapes({projection:r,geometries:t},n);return 0!==n.length&&console.warn("Unable to project "+n.length+" polygons"),o}},{key:"geographyShapeGeometry",value:function(e){var r=e.projection,t=this.data.objects.geography.geometries,n=[],o=this.shapeGeometry({projection:r,geometries:t},n);return 0!==n.length&&console.warn("Unable to project "+n.length+" polygons"),o}},{key:"geographyOutlineGeometry",value:function(e){var r=e.projection,t=this.data.objects.geography.geometries,n=[],o=this.outlineGeometry({projection:r,geometries:t},n);return 0!==n.length&&console.warn("Unable to project "+n.length+" polygons"),o}},{key:"geographySubdivisionGeometry",value:function(e){var t=e.projection,n=pe(this.levels[0]),o=[],i=this.borderGeometry({projection:t,object:this.data.objects.geography,filter:function(e,r){return e.properties[n]!==r.properties[n]}},o);return 0!==o.length?new r.BufferGeometry:i}},{key:"divisionShapes",value:function(e){var r=e.level,t=e.code,n=e.projection,o=this.data.objects.geography.geometries,i=[],u=this.shapes({projection:n,geometries:o.filter(function(e){return ve(r,t,e)})},i);return 0!==i.length&&console.warn(i.length+" polygons failed to project"),u}},{key:"divisionShapeGeometry",value:function(e){var r=e.level,t=e.code,n=e.projection,o=this.data.objects.geography.geometries,i=[],u=this.shapeGeometry({projection:n,geometries:o.filter(function(e){return ve(r,t,e)})},i);return 0!==i.length&&console.warn("Unable to project "+i.length+" polygons:",r,t),u}},{key:"divisionOutlineGeometry",value:function(e){var r=e.level,t=e.code,n=e.projection,o=this.data.objects.geography.geometries,i=[],u=this.outlineGeometry({projection:n,geometries:o.filter(function(e){return ve(r,t,e)})},i);return 0!==i.length&&console.warn("Unable to project "+i.length+" polygons:",r,t),u}},{key:"divisionBorderGeometry",value:function(e){var t=this,n=e.level,o=e.code,i=e.projection,u=function(){var e=t.levels.indexOf(n);if(-1===e)throw new Error('Could not find level "'+n+'" in geography');if(e>0)return t.levels[e-1]}(),a=this.data.objects.geography.geometries;u&&(a=a.filter(function(e){return ve(u,o,e)}));var s=a.filter(function(e){return ve(n,o,e)}).map(function(e){return a.indexOf(e)}),c=Gr.neighbors(a),f={type:"GeometryCollection",geometries:a.filter(function(e,r){return s.includes(r)||s.some(function(e){return c[e].includes(r)})})},l=pe(n),h=[],p=this.borderGeometry({projection:i,object:f,filter:function(e,r){return e.properties[l]===o?e.properties[l]<r.properties[l]:e.properties[l]>r.properties[l]}},h);return 0!==h.length?new r.BufferGeometry:p}},{key:"divisionSubdivisionGeometry",value:function(e){var t=e.level,n=e.code,o=e.projection,i={type:"GeometryCollection",geometries:this.data.objects.geography.geometries.filter(function(e){return ve(t,n,e)})},u=[],a=this.borderGeometry({projection:o,object:i,filter:function(e,r){return e!==r}},u);return 0!==u.length?new r.BufferGeometry:a}},{key:"levels",get:function(){var e=Pr(this);return[].concat(Ne(e.levels))}},{key:"data",get:function(){return Pr(this).data}}]),e}(),_r=function(e){function r(){return Ce(this,r),Me(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,"japan",[new yr("prefecture"),new yr("municipality",{coerce:function(e){return parseInt(e,10)},super:function(e){return parseInt((""+e).slice(0,-3),10)}})]))}return Pe(r,mr),r}(),Nr={primary:function(e){var r=be(60*e[1],40);return 100*r.quotient+1*(r=we(e[0]-100)).integral},secondary:function(e){var r=be(60*e[1],40),t=r.quotient,n=(r=be(r.remainder,5)).quotient;return 1e4*t+100*(r=we(e[0]-100)).integral+10*n+1*(r=be(60*r.fractional,7.5)).quotient},basic:function(e){var r=be(60*e[1],40),t=r.quotient,n=(r=be(r.remainder,5)).quotient,o=(r=be(60*r.remainder,30)).quotient;return 1e6*t+1e4*(r=we(e[0]-100)).integral+1e3*n+100*(r=be(60*r.fractional,7.5)).quotient+10*o+1*(r=be(60*r.remainder,45)).quotient},half:function(e){var r=be(60*e[1],40),t=r.quotient,n=(r=be(r.remainder,5)).quotient,o=(r=be(60*r.remainder,30)).quotient,i=(r=be(r.remainder,15)).quotient;return 1e7*t+1e5*(r=we(e[0]-100)).integral+1e4*n+1e3*(r=be(60*r.fractional,7.5)).quotient+100*o+10*(r=be(60*r.remainder,45)).quotient+1*(2*i+(r=be(r.remainder,22.5)).quotient+1)},quarter:function(e){var r=be(60*e[1],40),t=r.quotient,n=(r=be(r.remainder,5)).quotient,o=(r=be(60*r.remainder,30)).quotient,i=(r=be(r.remainder,15)).quotient,u=(r=be(r.remainder,7.5)).quotient;return 1e8*t+1e6*(r=we(e[0]-100)).integral+1e5*n+1e4*(r=be(60*r.fractional,7.5)).quotient+1e3*o+100*(r=be(60*r.remainder,45)).quotient+10*(2*i+(r=be(r.remainder,22.5)).quotient+1)+1*(2*u+(r=be(r.remainder,11.25)).quotient+1)},eighth:function(e){var r=be(60*e[1],40),t=r.quotient,n=(r=be(r.remainder,5)).quotient,o=(r=be(60*r.remainder,30)).quotient,i=(r=be(r.remainder,15)).quotient,u=(r=be(r.remainder,7.5)).quotient,a=(r=be(r.remainder,3.75)).quotient;return 1e9*t+1e7*(r=we(e[0]-100)).integral+1e6*n+1e5*(r=be(60*r.fractional,7.5)).quotient+1e4*o+1e3*(r=be(60*r.remainder,45)).quotient+100*(2*i+(r=be(r.remainder,22.5)).quotient+1)+10*(2*u+(r=be(r.remainder,11.25)).quotient+1)+1*(2*a+(r=be(r.remainder,5.625)).quotient+1)}},Br={primary:function(e){var r=be(e,100),t=r.quotient;return[3600*((r=be(r.remainder,1)).quotient+100)/3600,2400*t/3600]},secondary:function(e){var r=be(e,1e4),t=r.quotient,n=(r=be(r.remainder,100)).quotient,o=(r=be(r.remainder,10)).quotient;return[(3600*(n+100)+450*(r=be(r.remainder,1)).quotient)/3600,(2400*t+300*o)/3600]},basic:function(e){var r=be(e,1e6),t=r.quotient,n=(r=be(r.remainder,1e4)).quotient,o=(r=be(r.remainder,1e3)).quotient,i=(r=be(r.remainder,100)).quotient,u=(r=be(r.remainder,10)).quotient;return[(3600*(n+100)+450*i+45*(r=be(r.remainder,1)).quotient)/3600,(2400*t+300*o+30*u)/3600]},half:function(e){var r=be(e,1e7),t=r.quotient,n=(r=be(r.remainder,1e5)).quotient,o=(r=be(r.remainder,1e4)).quotient,i=(r=be(r.remainder,1e3)).quotient,u=(r=be(r.remainder,100)).quotient,a=(r=be(r.remainder,10)).quotient,s=(r=be(r.remainder,1)).quotient;return[(3600*(n+100)+450*i+45*a+22.5*(s-1&1))/3600,(2400*t+300*o+30*u+15*(s-1>>1))/3600]},quarter:function(e){var r=be(e,1e8),t=r.quotient,n=(r=be(r.remainder,1e6)).quotient,o=(r=be(r.remainder,1e5)).quotient,i=(r=be(r.remainder,1e4)).quotient,u=(r=be(r.remainder,1e3)).quotient,a=(r=be(r.remainder,100)).quotient,s=(r=be(r.remainder,10)).quotient,c=(r=be(r.remainder,1)).quotient;return[(3600*(n+100)+450*i+45*a+22.5*(s-1&1)+11.25*(c-1&1))/3600,(2400*t+300*o+30*u+15*(s-1>>1)+7.5*(c-1>>1))/3600]},eighth:function(e){var r=be(e,1e9),t=r.quotient,n=(r=be(r.remainder,1e7)).quotient,o=(r=be(r.remainder,1e6)).quotient,i=(r=be(r.remainder,1e5)).quotient,u=(r=be(r.remainder,1e4)).quotient,a=(r=be(r.remainder,1e3)).quotient,s=(r=be(r.remainder,100)).quotient,c=(r=be(r.remainder,10)).quotient,f=(r=be(r.remainder,1)).quotient;return[(3600*(n+100)+450*i+45*a+22.5*(s-1&1)+11.25*(c-1&1)+5.625*(f-1&1))/3600,(2400*t+300*o+30*u+15*(s-1>>1)+7.5*(c-1>>1)+3.75*(f-1>>1))/3600]}},Ir=i("JapanRegionalMesh"),Zr=function(){function e(r,t){Ce(this,e);var n=Ir(this);n.name=r,n.size=[].concat(Ne(t))}return Ee(e,[{key:"code",value:function(e){return Nr[this.name](e)}},{key:"origin",value:function(e){return Br[this.name](e)}},{key:"center",value:function(e){var r=this.origin(e),t=this.size;return[r[0]+t[0]/2,r[1]+t[1]/2]}},{key:"name",get:function(){return Ir(this).name}},{key:"size",get:function(){var e=Ir(this);return[].concat(Ne(e.size))}}]),e}(),zr={primary:new Zr("primary",[1,2400/3600]),secondary:new Zr("secondary",[.125,300/3600]),basic:new Zr("basic",[.0125,30/3600]),half:new Zr("half",[.00625,15/3600]),quarter:new Zr("quarter",[.003125,7.5/3600]),eighth:new Zr("eighth",[.0015625,3.75/3600])},Ur=u(function(e,r){!function(){function r(e){return e.valueOf()/R-.5+C}function t(e){return new Date((e+.5-C)*R)}function n(e){return r(e)-E}function o(e,r){return A(w(e)*k(T)-j(r)*w(T),k(e))}function i(e,r){return q(w(r)*k(T)+k(r)*w(T)*w(e))}function u(e,r,t){return A(w(e),k(e)*w(r)-j(t)*k(r))}function a(e,r,t){return q(w(r)*w(t)+k(r)*k(t)*k(e))}function s(e,r){return O*(280.16+360.9856235*e)-r}function c(e){return e<0&&(e=0),2967e-7/Math.tan(e+.00312536/(e+.08901179))}function f(e){return O*(357.5291+.98560028*e)}function l(e){return e+O*(1.9148*w(e)+.02*w(2*e)+3e-4*w(3*e))+102.9372*O+b}function h(e){var r=l(f(e));return{dec:i(r,0),ra:o(r,0)}}function p(e,r){return Math.round(e-M-r/(2*b))}function v(e,r,t){return M+(e+r)/(2*b)+t}function d(e,r,t){return E+e+.0053*w(r)-.0069*w(2*t)}function y(e,r,t){return S((w(e)-w(r)*w(t))/(k(r)*k(t)))}function g(e,r,t,n,o,i,u){return d(v(y(e,t,n),r,o),i,u)}function m(e){var r=O*(134.963+13.064993*e),t=O*(93.272+13.22935*e),n=O*(218.316+13.176396*e)+6.289*O*w(r),u=5.128*O*w(t),a=385001-20905*k(r);return{ra:o(n,u),dec:i(n,u),dist:a}}function x(e,r){return new Date(e.valueOf()+r*R/24)}var b=Math.PI,w=Math.sin,k=Math.cos,j=Math.tan,q=Math.asin,A=Math.atan2,S=Math.acos,O=b/180,R=864e5,C=2440588,E=2451545,T=23.4397*O,G={};G.getPosition=function(e,r,t){var o=O*-t,i=O*r,c=n(e),f=h(c),l=s(c,o)-f.ra;return{azimuth:u(l,i,f.dec),altitude:a(l,i,f.dec)}};var P=G.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];G.addTime=function(e,r,t){P.push([e,r,t])};var M=9e-4;G.getTimes=function(e,r,o){var u,a,s,c,h,y=O*-o,m=O*r,x=p(n(e),y),b=v(0,y,x),w=f(b),k=l(w),j=i(k,0),q=d(b,w,k),A={solarNoon:t(q),nadir:t(q-.5)};for(u=0,a=P.length;u<a;u+=1)h=q-((c=g((s=P[u])[0]*O,y,m,j,x,w,k))-q),A[s[1]]=t(h),A[s[2]]=t(c);return A},G.getMoonPosition=function(e,r,t){var o=O*-t,i=O*r,f=n(e),l=m(f),h=s(f,o)-l.ra,p=a(h,i,l.dec),v=A(w(h),j(i)*k(l.dec)-w(l.dec)*k(h));return p+=c(p),{azimuth:u(h,i,l.dec),altitude:p,distance:l.dist,parallacticAngle:v}},G.getMoonIllumination=function(e){var r=n(e||new Date),t=h(r),o=m(r),i=S(w(t.dec)*w(o.dec)+k(t.dec)*k(o.dec)*k(t.ra-o.ra)),u=A(149598e3*w(i),o.dist-149598e3*k(i)),a=A(k(t.dec)*w(t.ra-o.ra),w(t.dec)*k(o.dec)-k(t.dec)*w(o.dec)*k(t.ra-o.ra));return{fraction:(1+k(u))/2,phase:.5+.5*u*(a<0?-1:1)/Math.PI,angle:a}},G.getMoonTimes=function(e,r,t,n){var o=new Date(e);n?o.setUTCHours(0,0,0,0):o.setHours(0,0,0,0);for(var i,u,a,s,c,f,l,h,p,v,d,y,g,m=.133*O,b=G.getMoonPosition(o,r,t).altitude-m,w=1;w<=24&&(i=G.getMoonPosition(x(o,w),r,t).altitude-m,u=G.getMoonPosition(x(o,w+1),r,t).altitude-m,c=(b+u)/2-i,f=(u-b)/2,l=-f/(2*c),h=(c*l+f)*l+i,p=f*f-4*c*i,v=0,p>=0&&(d=l-(g=Math.sqrt(p)/(2*Math.abs(c))),y=l+g,Math.abs(d)<=1&&v++,Math.abs(y)<=1&&v++,d<-1&&(d=y)),1===v?b<0?a=w+d:s=w+d:2===v&&(a=w+(h<0?y:d),s=w+(h<0?d:y)),!a||!s);w+=2)b=u;var k={};return a&&(k.rise=x(o,a)),s&&(k.set=x(o,s)),a||s||(k[h>0?"alwaysUp":"alwaysDown"]=!0),k},e.exports=G}()}),Fr=u(function(e){!function(){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={rotl:function(e,r){return e<<r|e>>>32-r},rotr:function(e,r){return e<<32-r|e>>>r},endian:function(e){if(e.constructor==Number)return 16711935&t.rotl(e,8)|4278255360&t.rotl(e,24);for(var r=0;r<e.length;r++)e[r]=t.endian(e[r]);return e},randomBytes:function(e){for(var r=[];e>0;e--)r.push(Math.floor(256*Math.random()));return r},bytesToWords:function(e){for(var r=[],t=0,n=0;t<e.length;t++,n+=8)r[n>>>5]|=e[t]<<24-n%32;return r},wordsToBytes:function(e){for(var r=[],t=0;t<32*e.length;t+=8)r.push(e[t>>>5]>>>24-t%32&255);return r},bytesToHex:function(e){for(var r=[],t=0;t<e.length;t++)r.push((e[t]>>>4).toString(16)),r.push((15&e[t]).toString(16));return r.join("")},hexToBytes:function(e){for(var r=[],t=0;t<e.length;t+=2)r.push(parseInt(e.substr(t,2),16));return r},bytesToBase64:function(e){for(var t=[],n=0;n<e.length;n+=3)for(var o=e[n]<<16|e[n+1]<<8|e[n+2],i=0;i<4;i++)8*n+6*i<=8*e.length?t.push(r.charAt(o>>>6*(3-i)&63)):t.push("=");return t.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var t=[],n=0,o=0;n<e.length;o=++n%4)0!=o&&t.push((r.indexOf(e.charAt(n-1))&Math.pow(2,-2*o+8)-1)<<2*o|r.indexOf(e.charAt(n))>>>6-2*o);return t}};e.exports=t}()}),Jr={utf8:{stringToBytes:function(e){return Jr.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(Jr.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var r=[],t=0;t<e.length;t++)r.push(255&e.charCodeAt(t));return r},bytesToString:function(e){for(var r=[],t=0;t<e.length;t++)r.push(String.fromCharCode(e[t]));return r.join("")}}},Lr=Jr,Dr=function(e){return null!=e&&(ke(e)||je(e)||!!e._isBuffer)},Hr=u(function(e){!function(){var r=Fr,t=Lr.utf8,n=Dr,o=Lr.bin,i=function e(i,u){i.constructor==String?i=u&&"binary"===u.encoding?o.stringToBytes(i):t.stringToBytes(i):n(i)?i=Array.prototype.slice.call(i,0):Array.isArray(i)||(i=i.toString());for(var a=r.bytesToWords(i),s=8*i.length,c=1732584193,f=-271733879,l=-1732584194,h=271733878,p=0;p<a.length;p++)a[p]=16711935&(a[p]<<8|a[p]>>>24)|4278255360&(a[p]<<24|a[p]>>>8);a[s>>>5]|=128<<s%32,a[14+(s+64>>>9<<4)]=s;for(var v=e._ff,d=e._gg,y=e._hh,g=e._ii,p=0;p<a.length;p+=16){var m=c,x=f,b=l,w=h;f=g(f=g(f=g(f=g(f=y(f=y(f=y(f=y(f=d(f=d(f=d(f=d(f=v(f=v(f=v(f=v(f,l=v(l,h=v(h,c=v(c,f,l,h,a[p+0],7,-680876936),f,l,a[p+1],12,-389564586),c,f,a[p+2],17,606105819),h,c,a[p+3],22,-1044525330),l=v(l,h=v(h,c=v(c,f,l,h,a[p+4],7,-176418897),f,l,a[p+5],12,1200080426),c,f,a[p+6],17,-1473231341),h,c,a[p+7],22,-45705983),l=v(l,h=v(h,c=v(c,f,l,h,a[p+8],7,1770035416),f,l,a[p+9],12,-1958414417),c,f,a[p+10],17,-42063),h,c,a[p+11],22,-1990404162),l=v(l,h=v(h,c=v(c,f,l,h,a[p+12],7,1804603682),f,l,a[p+13],12,-40341101),c,f,a[p+14],17,-1502002290),h,c,a[p+15],22,1236535329),l=d(l,h=d(h,c=d(c,f,l,h,a[p+1],5,-165796510),f,l,a[p+6],9,-1069501632),c,f,a[p+11],14,643717713),h,c,a[p+0],20,-373897302),l=d(l,h=d(h,c=d(c,f,l,h,a[p+5],5,-701558691),f,l,a[p+10],9,38016083),c,f,a[p+15],14,-660478335),h,c,a[p+4],20,-405537848),l=d(l,h=d(h,c=d(c,f,l,h,a[p+9],5,568446438),f,l,a[p+14],9,-1019803690),c,f,a[p+3],14,-187363961),h,c,a[p+8],20,1163531501),l=d(l,h=d(h,c=d(c,f,l,h,a[p+13],5,-1444681467),f,l,a[p+2],9,-51403784),c,f,a[p+7],14,1735328473),h,c,a[p+12],20,-1926607734),l=y(l,h=y(h,c=y(c,f,l,h,a[p+5],4,-378558),f,l,a[p+8],11,-2022574463),c,f,a[p+11],16,1839030562),h,c,a[p+14],23,-35309556),l=y(l,h=y(h,c=y(c,f,l,h,a[p+1],4,-1530992060),f,l,a[p+4],11,1272893353),c,f,a[p+7],16,-155497632),h,c,a[p+10],23,-1094730640),l=y(l,h=y(h,c=y(c,f,l,h,a[p+13],4,681279174),f,l,a[p+0],11,-358537222),c,f,a[p+3],16,-722521979),h,c,a[p+6],23,76029189),l=y(l,h=y(h,c=y(c,f,l,h,a[p+9],4,-640364487),f,l,a[p+12],11,-421815835),c,f,a[p+15],16,530742520),h,c,a[p+2],23,-995338651),l=g(l,h=g(h,c=g(c,f,l,h,a[p+0],6,-198630844),f,l,a[p+7],10,1126891415),c,f,a[p+14],15,-1416354905),h,c,a[p+5],21,-57434055),l=g(l,h=g(h,c=g(c,f,l,h,a[p+12],6,1700485571),f,l,a[p+3],10,-1894986606),c,f,a[p+10],15,-1051523),h,c,a[p+1],21,-2054922799),l=g(l,h=g(h,c=g(c,f,l,h,a[p+8],6,1873313359),f,l,a[p+15],10,-30611744),c,f,a[p+6],15,-1560198380),h,c,a[p+13],21,1309151649),l=g(l,h=g(h,c=g(c,f,l,h,a[p+4],6,-145523070),f,l,a[p+11],10,-1120210379),c,f,a[p+2],15,718787259),h,c,a[p+9],21,-343485551),c=c+m>>>0,f=f+x>>>0,l=l+b>>>0,h=h+w>>>0}return r.endian([c,f,l,h])};i._ff=function(e,r,t,n,o,i,u){var a=e+(r&t|~r&n)+(o>>>0)+u;return(a<<i|a>>>32-i)+r},i._gg=function(e,r,t,n,o,i,u){var a=e+(r&n|t&~n)+(o>>>0)+u;return(a<<i|a>>>32-i)+r},i._hh=function(e,r,t,n,o,i,u){var a=e+(r^t^n)+(o>>>0)+u;return(a<<i|a>>>32-i)+r},i._ii=function(e,r,t,n,o,i,u){var a=e+(t^(r|~n))+(o>>>0)+u;return(a<<i|a>>>32-i)+r},i._blocksize=16,i._digestsize=16,e.exports=function(e,t){if(void 0===e||null===e)throw new Error("Illegal argument "+e);var n=r.wordsToBytes(i(e,t));return t&&t.asBytes?n:t&&t.asString?o.bytesToString(n):r.bytesToHex(n)}}()}),Vr={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},Qr=function(e){throw{name:"SyntaxError",message:e,at:Sr,text:Rr}},Wr=function(e){return e&&e!==Or&&Qr("Expected '"+e+"' instead of '"+Or+"'"),Or=Rr.charAt(Sr),Sr+=1,Or},Yr=function(){var e,r="";for("-"===Or&&(r="-",Wr("-"));Or>="0"&&Or<="9";)r+=Or,Wr();if("."===Or)for(r+=".";Wr()&&Or>="0"&&Or<="9";)r+=Or;if("e"===Or||"E"===Or)for(r+=Or,Wr(),"-"!==Or&&"+"!==Or||(r+=Or,Wr());Or>="0"&&Or<="9";)r+=Or,Wr();if(e=+r,isFinite(e))return e;Qr("Bad number")},$r=function(){var e,r,t,n="";if('"'===Or)for(;Wr();){if('"'===Or)return Wr(),n;if("\\"===Or)if(Wr(),"u"===Or){for(t=0,r=0;r<4&&(e=parseInt(Wr(),16),isFinite(e));r+=1)t=16*t+e;n+=String.fromCharCode(t)}else{if("string"!=typeof Vr[Or])break;n+=Vr[Or]}else n+=Or}Qr("Bad string")},Xr=function(){for(;Or&&Or<=" ";)Wr()},Kr=function(){switch(Or){case"t":return Wr("t"),Wr("r"),Wr("u"),Wr("e"),!0;case"f":return Wr("f"),Wr("a"),Wr("l"),Wr("s"),Wr("e"),!1;case"n":return Wr("n"),Wr("u"),Wr("l"),Wr("l"),null}Qr("Unexpected '"+Or+"'")},et=function(){var e=[];if("["===Or){if(Wr("["),Xr(),"]"===Or)return Wr("]"),e;for(;Or;){if(e.push(Cr()),Xr(),"]"===Or)return Wr("]"),e;Wr(","),Xr()}}Qr("Bad array")},rt=function(){var e,r={};if("{"===Or){if(Wr("{"),Xr(),"}"===Or)return Wr("}"),r;for(;Or;){if(e=$r(),Xr(),Wr(":"),Object.hasOwnProperty.call(r,e)&&Qr('Duplicate key "'+e+'"'),r[e]=Cr(),Xr(),"}"===Or)return Wr("}"),r;Wr(","),Xr()}}Qr("Bad object")};Cr=function(){switch(Xr(),Or){case"{":return rt();case"[":return et();case'"':return $r();case"-":return Yr();default:return Or>="0"&&Or<="9"?Yr():Kr()}};var tt,nt,ot,it=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,ut={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},at={parse:function(e,r){var t;return Rr=e,Sr=0,Or=" ",t=Cr(),Xr(),Or&&Qr("Syntax error"),"function"==typeof r?function e(t,n){var o,i,u=t[n];if(u&&"object"===(void 0===u?"undefined":Oe(u)))for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(void 0!==(i=e(u,o))?u[o]=i:delete u[o]);return r.call(t,n,u)}({"":t},""):t},stringify:function(e,r,t){var n;if(tt="",nt="","number"==typeof t)for(n=0;n<t;n+=1)nt+=" ";else"string"==typeof t&&(nt=t);if(ot=r,r&&"function"!=typeof r&&("object"!==(void 0===r?"undefined":Oe(r))||"number"!=typeof r.length))throw new Error("JSON.stringify");return Ae("",{"":e})}},st="undefined"!=typeof JSON?JSON:at,ct=function(e,r){r||(r={}),"function"==typeof r&&(r={cmp:r});var t=r.space||"";"number"==typeof t&&(t=Array(t+1).join(" "));var n="boolean"==typeof r.cycles&&r.cycles,o=r.replacer||function(e,r){return r},i=r.cmp&&function(e){return function(r){return function(t,n){var o={key:t,value:r[t]},i={key:n,value:r[n]};return e(o,i)}}}(r.cmp),u=[];return function e(r,a,s,c){var f=t?"\n"+new Array(c+1).join(t):"",l=t?": ":":";if(s&&s.toJSON&&"function"==typeof s.toJSON&&(s=s.toJSON()),void 0!==(s=o.call(r,a,s))){if("object"!==(void 0===s?"undefined":Oe(s))||null===s)return st.stringify(s);if(ft(s)){for(var h=[],p=0;p<s.length;p++){var v=e(s,p,s[p],c+1)||st.stringify(null);h.push(f+t+v)}return"["+h.join(",")+f+"]"}if(-1!==u.indexOf(s)){if(n)return st.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}u.push(s);for(var d=lt(s).sort(i&&i(s)),h=[],p=0;p<d.length;p++){var y=e(s,a=d[p],s[a],c+1);if(y){var g=st.stringify(a)+l+y;h.push(f+t+g)}}return u.splice(u.indexOf(s),1),"{"+h.join(",")+f+"}"}}({"":e},"",e,0)},ft=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},lt=Object.keys||function(e){var r=Object.prototype.hasOwnProperty||function(){return!0},t=[];for(var n in e)r.call(e,n)&&t.push(n);return t},ht=Object.assign({},t,n,o),pt=i("Projection"),vt=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=r.name,n=void 0===t?"Equirectangular":t,o=r.scale,i=void 0===o?1e4:o,u=r.origin,a=void 0===u?[0,0]:u,s=r.rotates,c=void 0===s?[!0,!0]:s;Ce(this,e);var f=pt(this);f.name=n,f.scale=+i||1,Array.isArray(a)?f.origin=[+a[0]||0,+a[1]||0]:f.origin=[+a||0,+a||0],Array.isArray(c)?f.rotates=[!!c[0],!!c[1]]:f.rotates=[!!c,!!c],f.projector=this.projector}return Ee(e,[{key:"project",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=pt(this).projector(e);if(Number.isNaN(t[0])||Number.isNaN(t[1]))throw new Error("Could not project point ["+e+"]");return r&&(t[1]=-t[1]||0),t}},{key:"unproject",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=pt(this).projector.invert([e[0],r?-e[1]||0:e[1]]);if(Number.isNaN(t[0])||Number.isNaN(t[1]))throw new Error("Could not unproject point ["+e+"]");return t}},{key:"sun",value:function(e){var r=this.origin;return Ur.getPosition(e,r[1],r[0])}},{key:"moon",value:function(e){var r=this.origin;return Ur.getMoonPosition(e,r[1],r[0])}},{key:"equals",value:function(e){return this.name===e.name&&this.scale===e.scale&&this.origin[0]===e.origin[0]&&this.origin[1]===e.origin[1]&&this.rotates[0]===e.rotates[0]&&this.rotates[1]===e.rotates[1]}},{key:"toJSON",value:function(){return{name:this.name,scale:this.scale,origin:this.origin,rotates:this.rotates}}},{key:"projector",get:function(){var e=ht["geo"+this.name];if(void 0===e)throw new Error('Could not find projection for name "'+this.name+'"');var r=e();if("function"==typeof r.rotate){var t=[0,0,0];this.rotates[0]&&(t[0]=-this.origin[0]),this.rotates[1]&&(t[1]=-this.origin[1]),r.rotate(t)}r.translate([0,0]),r.scale(this.scale);var n=r(this.origin);return Array.isArray(n)&&r.translate([-n[0],-n[1]]),r}},{key:"path",get:function(){var e=pt(this);return ht.geoPath().projection(e.projector)}},{key:"name",get:function(){return pt(this).name}},{key:"scale",get:function(){return pt(this).scale}},{key:"origin",get:function(){var e=pt(this);return[].concat(Ne(e.origin))}},{key:"rotates",get:function(){var e=pt(this);return[].concat(Ne(e.rotates))}},{key:"hash",get:function(){var e=pt(this);return void 0===e.hash&&(e.hash=Se(this.toJSON())),e.hash}}]),e}(),dt=function(e){function r(){return Ce(this,r),Me(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,"us",[new yr("state"),new yr("county",{coerce:function(e){return parseInt(e,10)},super:function(e){return parseInt((""+e).slice(0,-3),10)}})]))}return Pe(r,mr),r}(),yt=function(e){function r(){return Ce(this,r),Me(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,"world",[new yr("country")]))}return Pe(r,mr),r}();e.Division=Ie,e.DivisionLevel=yr,e.Geography=mr,e.GeographyBuilder=Mr,e.GeometryPack=vr,e.JapanGeography=_r,e.JapanRegionalMesh=zr,e.Path=Er,e.Projection=vt,e.USGeography=dt,e.WorldGeography=yt,Object.defineProperty(e,"__esModule",{value:!0})});